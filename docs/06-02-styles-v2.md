# –°—Ç–∏–ª–∏ v2: –ì—Ä—É–ø–ø—ã + –ü–æ–¥—Å—Ç–∏–ª–∏

## –¶–µ–ª—å
–£–ª—É—á—à–∏—Ç—å –∫–æ–Ω–≤–µ—Ä—Å–∏—é –≤—ã–±–æ—Ä–∞ —Å—Ç–∏–ª–µ–π —á–µ—Ä–µ–∑ –∏–µ—Ä–∞—Ä—Ö–∏—á–µ—Å–∫—É—é —Å—Ç—Ä—É–∫—Ç—É—Ä—É: –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å–Ω–∞—á–∞–ª–∞ –≤—ã–±–∏—Ä–∞–µ—Ç –∫–∞—Ç–µ–≥–æ—Ä–∏—é (–≥—Ä—É–ø–ø—É), –∑–∞—Ç–µ–º –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π –ø–æ–¥—Å—Ç–∏–ª—å.

## –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è
- Feature flag: —Å–Ω–∞—á–∞–ª–∞ —Ç–æ–ª—å–∫–æ –¥–ª—è —Ç–µ—Å—Ç–æ–≤–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (telegram_id: 42269230)
- –û–±—Ä–∞—Ç–Ω–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å: —Ç–µ–∫—É—â–∏–µ —Å—Ç–∏–ª–∏ –ø—Ä–æ–¥–æ–ª–∂–∞—é—Ç —Ä–∞–±–æ—Ç–∞—Ç—å
- –ë–µ–∑ –≤–ª–∏—è–Ω–∏—è –Ω–∞ worker: –≥–µ–Ω–µ—Ä–∞—Ü–∏—è –ø–æ–ª—É—á–∞–µ—Ç —Ñ–∏–Ω–∞–ª—å–Ω—ã–π `style_id`

## –ò–∑–æ–ª—è—Ü–∏—è (–í–ê–ñ–ù–û!)

| –ö–æ–º–ø–æ–Ω–µ–Ω—Ç | –°—Ç–∞—Ä—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ | –¢–µ—Å—Ç–æ–≤—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å (v2) |
|-----------|---------------------|---------------------------|
| –¢–∞–±–ª–∏—Ü–∞ —Å—Ç–∏–ª–µ–π | `style_presets` | `style_presets_v2` (–Ω–æ–≤–∞—è!) |
| –¢–∞–±–ª–∏—Ü–∞ –≥—Ä—É–ø–ø | ‚Äî | `style_groups` (–Ω–æ–≤–∞—è!) |
| UI | –ü–ª–æ—Å–∫–∏–π —Å–ø–∏—Å–æ–∫ | –ì—Ä—É–ø–ø—ã ‚Üí –ø–æ–¥—Å—Ç–∏–ª–∏ |
| –ö–æ–¥ | `sendStyleKeyboard()` | `sendStyleGroupsKeyboard()` |

**`style_presets` –ù–ï –ò–ó–ú–ï–ù–Ø–ï–¢–°–Ø!**

---

## 1. –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –≥—Ä—É–ø–ø

| # | ID | Emoji | –ù–∞–∑–≤–∞–Ω–∏–µ RU | –ù–∞–∑–≤–∞–Ω–∏–µ EN | –ü–æ–¥—Å—Ç–∏–ª–µ–π |
|---|-----|-------|-------------|-------------|-----------|
| 1 | `anime` | üéå | –ê–Ω–∏–º–µ | Anime | 5 |
| 2 | `meme` | üòÇ | –ú–µ–º—ã | Memes | 4 |
| 3 | `cute` | ü•∞ | –ú–∏–ª—ã–π | Cute | 4 |
| 4 | `love` | üíï | –†–æ–º–∞–Ω—Ç–∏–∫–∞ | Romance | 4 |
| 5 | `cartoon` | üé® | –ú—É–ª—å—Ç—Ñ–∏–ª—å–º | Cartoon | 4 |
| 6 | `game` | üéÆ | –ò–≥—Ä–æ–≤–æ–π | Gaming | 3 |
| 7 | `drawn` | ‚úèÔ∏è | –†–∏—Å—É–Ω–æ–∫ | Drawn | 3 |
| 8 | `manhwa` | üìö | –ú–∞–Ω—Ö–≤–∞ | Manhwa | 3 |
| 9 | `tv` | üì∫ | –°–µ—Ä–∏–∞–ª—ã | TV Series | 5 |
| 10 | `russian` | üá∑üá∫ | –†—É—Å—Å–∫–∏–π —Å—Ç–∏–ª—å | Russian | 7 |

**–ò—Ç–æ–≥–æ: 10 –≥—Ä—É–ø–ø, 42 –ø–æ–¥—Å—Ç–∏–ª—è**

---

## 2. –ü–æ–¥—Å—Ç–∏–ª–∏ –ø–æ –≥—Ä—É–ø–ø–∞–º

### üéå anime

| ID | Emoji | –ù–∞–∑–≤–∞–Ω–∏–µ RU | –ù–∞–∑–≤–∞–Ω–∏–µ EN | prompt_hint |
|----|-------|-------------|-------------|-------------|
| `anime_classic` | üéØ | –ö–ª–∞—Å—Å–∏—á–µ—Å–∫–∏–π | Classic | Japanese anime style, clean precise linework, cel-shading, large expressive eyes with detailed reflections, stylized flowing hair |
| `anime_dark` | üåë | –¢—ë–º–Ω—ã–π | Dark | Dark anime aesthetic, dramatic shadows, intense brooding eyes, muted colors with red/purple accents, seinen manga style |
| `anime_shonen` | ‚öîÔ∏è | –°—ë–Ω–µ–Ω | Shonen | Shonen anime style, dynamic action pose, spiky hair, determined fierce expression, vibrant saturated colors |
| `anime_romance` | üíó | –†–æ–º–∞–Ω—Ç–∏–∫ | Romance | Shoujo anime style, soft pastel colors, sparkles and bubbles, dreamy starry eyes, delicate features, bishoujo aesthetic |
| `anime_chibi` | üç° | –ß–∏–±–∏ | Chibi | Super-deformed chibi anime, oversized head 3x body, tiny limbs, kawaii expression, simplified features |

### üòÇ meme

| ID | Emoji | –ù–∞–∑–≤–∞–Ω–∏–µ RU | –ù–∞–∑–≤–∞–Ω–∏–µ EN | prompt_hint |
|----|-------|-------------|-------------|-------------|
| `meme_classic` | üò§ | –ö–ª–∞—Å—Å–∏–∫–∞ | Classic | Internet meme style, rage comic aesthetic, bold black outlines, extremely exaggerated facial expression, simple shapes |
| `meme_pepe` | üê∏ | –ü–µ–ø–µ | Pepe | Pepe the frog meme style, green character, simple round shapes, expressive sad or smug face, iconic meme aesthetic |
| `meme_modern` | üî• | –°–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–π | Modern | Modern zoomer meme style, ironic aesthetic, chaotic energy, distorted proportions, TikTok meme vibe |
| `meme_reaction` | üò± | –†–µ–∞–∫—Ü–∏—è | Reaction | Reaction meme face, extremely over-the-top expression, screenshot aesthetic, viral meme energy |

### ü•∞ cute

| ID | Emoji | –ù–∞–∑–≤–∞–Ω–∏–µ RU | –ù–∞–∑–≤–∞–Ω–∏–µ EN | prompt_hint |
|----|-------|-------------|-------------|-------------|
| `cute_kawaii` | ‚ú® | –ö–∞–≤–∞–∏–π | Kawaii | Japanese kawaii style, pastel pink and blue colors, round soft shapes, sparkles, blush cheeks, heart eyes |
| `cute_cat` | üê± | –ö–æ—Ç–∏–∫ | Cat | Cute cat character style, cat ears added, whiskers, playful feline expression, fluffy and adorable |
| `cute_animal` | üêæ | –ó–≤–µ—Ä—É—à–∫–∞ | Animal | Cute anthropomorphic animal, round fluffy body, oversized sparkly eyes, soft fur texture, adorable pose |
| `cute_plush` | üß∏ | –ü–ª—é—à–µ–≤—ã–π | Plush | Plush toy aesthetic, soft fabric texture, stitched details, huggable round shape, button eyes |

### üíï love

| ID | Emoji | –ù–∞–∑–≤–∞–Ω–∏–µ RU | –ù–∞–∑–≤–∞–Ω–∏–µ EN | prompt_hint |
|----|-------|-------------|-------------|-------------|
| `love_soft` | üå∏ | –ù–µ–∂–Ω—ã–π | Soft | Soft romantic style, watercolor effect, floating hearts, warm pink tones, dreamy gentle expression |
| `love_couple` | üë´ | –ü–∞—Ä–æ—á–∫–∏ | Couple | Romantic couple style, two characters close together, loving gaze, holding hands or hugging pose |
| `love_heart` | üíñ | –° —Å–µ—Ä–¥–µ—á–∫–∞–º–∏ | Hearts | Romantic style with heart decorations, heart-shaped elements, love symbols, pink and red palette |
| `love_passion` | üî• | –°—Ç—Ä–∞—Å—Ç–Ω—ã–π | Passionate | Passionate romantic style, intense loving gaze, dramatic lighting, deep red and warm tones |

### üé® cartoon

| ID | Emoji | –ù–∞–∑–≤–∞–Ω–∏–µ RU | –ù–∞–∑–≤–∞–Ω–∏–µ EN | prompt_hint |
|----|-------|-------------|-------------|-------------|
| `cartoon_american` | üá∫üá∏ | –ê–º–µ—Ä–∏–∫–∞–Ω—Å–∫–∏–π | American | American cartoon style, bold black outlines, flat bright colors, exaggerated proportions, expressive |
| `cartoon_retro` | üì∫ | –†–µ—Ç—Ä–æ | Retro | Retro Soviet cartoon style, warm nostalgic colors, hand-painted aesthetic, classic animation look |
| `cartoon_modern` | üíé | –°–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–π | Modern | Modern vector cartoon, clean geometric shapes, trendy flat design, minimalist features, stylish |
| `cartoon_3d` | üé¨ | 3D —Å—Ç–∏–ª—å | 3D Style | 3D animated movie style, soft subsurface lighting, Pixar-like render, smooth surfaces, cinematic |

### üéÆ game

| ID | Emoji | –ù–∞–∑–≤–∞–Ω–∏–µ RU | –ù–∞–∑–≤–∞–Ω–∏–µ EN | prompt_hint |
|----|-------|-------------|-------------|-------------|
| `game_pixel` | üëæ | –ü–∏–∫—Å–µ–ª—å | Pixel | 8-bit pixel art style, retro game aesthetic, limited color palette, blocky pixelated look, nostalgic |
| `game_rpg` | ‚öîÔ∏è | RPG | RPG | Fantasy RPG character style, epic hero pose, magical effects, detailed armor or costume, game art |
| `game_mobile` | üì± | –ú–æ–±–∏–ª—å–Ω—ã–π | Mobile | Mobile game art style, bright saturated colors, cute proportions, casual game aesthetic |

### ‚úèÔ∏è drawn

| ID | Emoji | –ù–∞–∑–≤–∞–Ω–∏–µ RU | –ù–∞–∑–≤–∞–Ω–∏–µ EN | prompt_hint |
|----|-------|-------------|-------------|-------------|
| `drawn_sketch` | ‚úèÔ∏è | –°–∫–µ—Ç—á | Sketch | Pencil sketch style, hand-drawn rough lines, artistic strokes, unfinished aesthetic, graphite look |
| `drawn_watercolor` | üíß | –ê–∫–≤–∞—Ä–µ–ª—å | Watercolor | Watercolor painting style, soft wet edges, color bleeding, artistic brush strokes, dreamy |
| `drawn_ink` | üñ§ | –¢—É—à—å | Ink | Black ink drawing style, bold confident strokes, high contrast, artistic linework, monochrome |

### üìö manhwa

| ID | Emoji | –ù–∞–∑–≤–∞–Ω–∏–µ RU | –ù–∞–∑–≤–∞–Ω–∏–µ EN | prompt_hint |
|----|-------|-------------|-------------|-------------|
| `manhwa_classic` | üìñ | –ö–ª–∞—Å—Å–∏–∫–∞ | Classic | Korean manhwa webtoon style, sharp defined features, detailed eyes, clean digital art, vertical scroll aesthetic |
| `manhwa_romance` | üíï | –†–æ–º–∞–Ω—Ç–∏–∫ | Romance | Romance manhwa style, beautiful detailed characters, soft coloring, emotional expression, webtoon romance |
| `manhwa_action` | üí• | –≠–∫—à–Ω | Action | Action manhwa style, dynamic poses, intense expression, dramatic angles, powerful energy effects |

### üì∫ tv

| ID | Emoji | –ù–∞–∑–≤–∞–Ω–∏–µ RU | –ù–∞–∑–≤–∞–Ω–∏–µ EN | prompt_hint |
|----|-------|-------------|-------------|-------------|
| `tv_american` | üá∫üá∏ | –ê–º–µ—Ä–∏–∫–∞–Ω—Å–∫–∏–π –º—É–ª—å—Ç—Å–µ—Ä–∏–∞–ª | American Cartoon | American TV cartoon style like Simpsons or Family Guy, yellow skin tone optional, bold outlines, flat colors, overbite, simplified features |
| `tv_adult` | üîû | –í–∑—Ä–æ—Å–ª–∞—è –∞–Ω–∏–º–∞—Ü–∏—è | Adult Animation | Adult animated series style like South Park or Rick and Morty, crude simple shapes, satirical exaggerated features, bold flat colors |
| `tv_kids` | üë∂ | –î–µ—Ç—Å–∫–∏–π –º—É–ª—å—Ç–∏–∫ | Kids Cartoon | Children's cartoon style like Gravity Falls or Adventure Time, round friendly shapes, bright colors, cute expressive characters |
| `tv_disney` | üè∞ | –î–∏—Å–Ω–µ–π/–ü–∏–∫—Å–∞—Ä | Disney/Pixar | Disney or Pixar animation style, 3D rendered look, expressive big eyes, soft lighting, polished animated movie aesthetic |
| `tv_hellish` | üòà | –ê–¥—Å–∫–∞—è —Ç–µ–º–∞ | Hellish Theme | Hazbin Hotel or Helluva Boss style, demon aesthetic, sharp angles, red and black palette, edgy cartoon look |

### üá∑üá∫ russian

| ID | Emoji | –ù–∞–∑–≤–∞–Ω–∏–µ RU | –ù–∞–∑–≤–∞–Ω–∏–µ EN | prompt_hint |
|----|-------|-------------|-------------|-------------|
| `ru_90s` | üìº | 90-–µ | 90s Style | Russian 90s aesthetic, VHS quality, grainy texture, post-Soviet style, tracksuit gopnik vibe, nostalgic faded colors |
| `ru_love_is` | üíë | –õ—é–±–æ–≤—å —ç—Ç–æ... | Love Is... | Love Is comic strip style, simple cute couple, minimal lines, sweet romantic, Kim Casali inspired, heart-shaped elements |
| `ru_soviet_cartoon` | üé¨ | –°–æ–≤–µ—Ç—Å–∫–∏–π –º—É–ª—å—Ç–∏–∫ | Soviet Cartoon | Soviet animation style like Nu Pogodi or Cheburashka, hand-painted aesthetic, warm nostalgic colors, classic USSR cartoon |
| `ru_ussr_aesthetic` | ‚ò≠ | –≠—Å—Ç–µ—Ç–∏–∫–∞ –°–°–°–† | USSR Aesthetic | Soviet propaganda poster style, constructivist aesthetic, bold red and gold colors, heroic worker pose, socialist realism, vintage USSR design |
| `ru_bogatyr` | ‚öîÔ∏è | –ë–æ–≥–∞—Ç—ã—Ä—å | Russian Hero | Russian bogatyr hero style, Tri Bogatyrya animation aesthetic, Slavic folklore, epic warrior, traditional Russian elements |
| `ru_gopnik` | üß¢ | –ü–∞—Ü–∞–Ω | Gopnik | Gopnik style, squatting pose, tracksuit Adidas aesthetic, Slavic meme culture, cigarette and semechki optional |
| `ru_criminal` | üé∞ | –ë—Ä–∏–≥–∞–¥–∞/90–µ –∫–∏–Ω–æ | 90s Crime | Russian 90s crime movie aesthetic, Brigada or Brat style, dark gritty, leather jacket, serious intense expression |

---

## 3. –ú–∏–≥—Ä–∞—Ü–∏—è –ë–î

### 3.1 –¢–∞–±–ª–∏—Ü–∞ `style_groups`

```sql
CREATE TABLE IF NOT EXISTS style_groups (
  id text PRIMARY KEY,
  emoji text NOT NULL,
  name_ru text NOT NULL,
  name_en text NOT NULL,
  sort_order int DEFAULT 0,
  is_active boolean DEFAULT true,
  created_at timestamptz DEFAULT now()
);

CREATE INDEX IF NOT EXISTS style_groups_active_idx 
ON style_groups (is_active, sort_order);
```

### 3.2 –ù–æ–≤–∞—è —Ç–∞–±–ª–∏—Ü–∞ `style_presets_v2` (–ø–æ–ª–Ω–∞—è –∏–∑–æ–ª—è—Ü–∏—è)

```sql
-- –û—Ç–¥–µ–ª—å–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞ –¥–ª—è –ø–æ–¥—Å—Ç–∏–ª–µ–π v2 - –ù–ï —Ç—Ä–æ–≥–∞–µ–º style_presets!
CREATE TABLE IF NOT EXISTS style_presets_v2 (
  id text PRIMARY KEY,
  group_id text NOT NULL REFERENCES style_groups(id),
  emoji text NOT NULL,
  name_ru text NOT NULL,
  name_en text NOT NULL,
  prompt_hint text NOT NULL,
  sort_order int DEFAULT 0,
  is_active boolean DEFAULT true,
  created_at timestamptz DEFAULT now()
);

CREATE INDEX IF NOT EXISTS style_presets_v2_idx 
ON style_presets_v2 (group_id, is_active, sort_order);
```

**–í–∞–∂–Ω–æ:** –°—É—â–µ—Å—Ç–≤—É—é—â–∞—è —Ç–∞–±–ª–∏—Ü–∞ `style_presets` –ù–ï –∏–∑–º–µ–Ω—è–µ—Ç—Å—è. –°—Ç–∞—Ä—ã–π UI –ø—Ä–æ–¥–æ–ª–∂–∞–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å –∫–∞–∫ —Ä–∞–Ω—å—à–µ.

### 3.3 –ê–Ω–∞–ª–∏—Ç–∏–∫–∞

```sql
ALTER TABLE sessions 
ADD COLUMN IF NOT EXISTS selected_style_group text;
```

---

## 4. Feature Flag

### 4.1 –ö–æ–Ω—Ñ–∏–≥

```typescript
// src/config.ts
export const STYLES_V2_ENABLED_USERS: number[] = [
  42269230,  // —Ç–µ—Å—Ç–æ–≤—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å
];
```

### 4.2 –•–µ–ª–ø–µ—Ä

```typescript
function useStylesV2(telegramId: number): boolean {
  return config.stylesV2EnabledUsers?.includes(telegramId) ?? false;
}
```

---

## 5. UI Flow

### 5.1 –í—ã–±–æ—Ä –≥—Ä—É–ø–ø—ã (–ø–µ—Ä–≤—ã–π —ç–∫—Ä–∞–Ω)

**–°–æ–æ–±—â–µ–Ω–∏–µ:** "–í—ã–±–µ—Ä–∏ –∫–∞—Ç–µ–≥–æ—Ä–∏—é —Å—Ç–∏–ª—è:"

**–ö–Ω–æ–ø–∫–∏ (2 –∫–æ–ª–æ–Ω–∫–∏):**
```
[üéå –ê–Ω–∏–º–µ] [üòÇ –ú–µ–º—ã]
[ü•∞ –ú–∏–ª—ã–π] [üíï –†–æ–º–∞–Ω—Ç–∏–∫–∞]
[üé® –ú—É–ª—å—Ç—Ñ–∏–ª—å–º] [üéÆ –ò–≥—Ä–æ–≤–æ–π]
[‚úèÔ∏è –†–∏—Å—É–Ω–æ–∫] [üìö –ú–∞–Ω—Ö–≤–∞]
[üì∫ –°–µ—Ä–∏–∞–ª—ã] [üá∑üá∫ –†—É—Å—Å–∫–∏–π]
[‚úçÔ∏è –°–≤–æ–π —Å—Ç–∏–ª—å]
```

**Callback –≥—Ä—É–ø–ø—ã:** `style_group:{group_id}`
**Callback —Å–≤–æ–π —Å—Ç–∏–ª—å:** `style_custom_v2`

### 5.2 –í—ã–±–æ—Ä –ø–æ–¥—Å—Ç–∏–ª—è (–≤—Ç–æ—Ä–æ–π —ç–∫—Ä–∞–Ω)

**–°–æ–æ–±—â–µ–Ω–∏–µ:** "üéå –ê–Ω–∏–º–µ ‚Äî –≤—ã–±–µ—Ä–∏ —Å—Ç–∏–ª—å:"

**–ö–Ω–æ–ø–∫–∏ (1 –∫–æ–ª–æ–Ω–∫–∞):**
```
[üéØ –ö–ª–∞—Å—Å–∏—á–µ—Å–∫–∏–π]
[üåë –¢—ë–º–Ω—ã–π]
[‚öîÔ∏è –°—ë–Ω–µ–Ω]
[üíó –†–æ–º–∞–Ω—Ç–∏–∫]
[üç° –ß–∏–±–∏]
[‚¨ÖÔ∏è –ù–∞–∑–∞–¥]
```

**Callback –ø–æ–¥—Å—Ç–∏–ª—è:** `style_v2:{substyle_id}`
**Callback –Ω–∞–∑–∞–¥:** `style_groups_back`

### 5.3 –°–≤–æ–π —Å—Ç–∏–ª—å (custom)

**–§–ª–æ—É –∞–Ω–∞–ª–æ–≥–∏—á–µ–Ω custom —ç–º–æ—Ü–∏—è–º:**

1. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–∞–∂–∏–º–∞–µ—Ç "‚úçÔ∏è –°–≤–æ–π —Å—Ç–∏–ª—å"
2. –ë–æ—Ç: "–û–ø–∏—à–∏ –∂–µ–ª–∞–µ–º—ã–π —Å—Ç–∏–ª—å (–Ω–∞–ø—Ä–∏–º–µ—Ä: –≤ —Å—Ç–∏–ª–µ –∫–æ–º–∏–∫—Å–æ–≤ Marvel, –∫–∞–∫ –ø–µ—Ä—Å–æ–Ω–∞–∂ –ù–∞—Ä—É—Ç–æ, –≤ —Å—Ç–∏–ª–µ —Å–æ–≤–µ—Ç—Å–∫–æ–≥–æ –ø–ª–∞–∫–∞—Ç–∞):"
3. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–≤–æ–¥–∏—Ç —Ç–µ–∫—Å—Ç
4. –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Å `style_id = 'custom'` –∏ `custom_style_prompt = –≤–≤–µ–¥—ë–Ω–Ω—ã–π —Ç–µ–∫—Å—Ç`

**Session state:** `wait_custom_style_v2`

**Callback:** `style_custom_v2` ‚Üí —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç state, –ø—Ä–æ—Å–∏—Ç –≤–≤–µ—Å—Ç–∏ —Ç–µ–∫—Å—Ç

---

## 6. –ö–æ–¥ –∏–∑–º–µ–Ω–µ–Ω–∏—è

### 6.1 –ù–æ–≤—ã–µ —Ö–µ–Ω–¥–ª–µ—Ä—ã

```typescript
// –ü–æ–∫–∞–∑–∞—Ç—å –≥—Ä—É–ø–ø—ã
bot.action("show_style_groups", async (ctx) => { ... });

// –í—ã–±—Ä–∞–Ω–∞ –≥—Ä—É–ø–ø–∞ ‚Üí –ø–æ–∫–∞–∑–∞—Ç—å –ø–æ–¥—Å—Ç–∏–ª–∏
bot.action(/^style_group:(.+)$/, async (ctx) => { ... });

// –í—ã–±—Ä–∞–Ω –ø–æ–¥—Å—Ç–∏–ª—å ‚Üí –≥–µ–Ω–µ—Ä–∞—Ü–∏—è
bot.action(/^style_v2:(.+)$/, async (ctx) => { ... });

// –ù–∞–∑–∞–¥ –∫ –≥—Ä—É–ø–ø–∞–º
bot.action("style_groups_back", async (ctx) => { ... });

// –°–≤–æ–π —Å—Ç–∏–ª—å (–∫–Ω–æ–ø–∫–∞) ‚Üí –∑–∞–ø—Ä–æ—Å —Ç–µ–∫—Å—Ç–∞
bot.action("style_custom_v2", async (ctx) => {
  // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º state = wait_custom_style_v2
  // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ "–û–ø–∏—à–∏ –∂–µ–ª–∞–µ–º—ã–π —Å—Ç–∏–ª—å:"
});

// –û–±—Ä–∞–±–æ—Ç–∫–∞ —Ç–µ–∫—Å—Ç–æ–≤–æ–≥–æ –≤–≤–æ–¥–∞ –¥–ª—è custom —Å—Ç–∏–ª—è
// –í message handler –ø—Ä–æ–≤–µ—Ä—è–µ–º session.state === 'wait_custom_style_v2'
// –°–æ—Ö—Ä–∞–Ω—è–µ–º —Ç–µ–∫—Å—Ç –≤ session.custom_style_prompt
// –ó–∞–ø—É—Å–∫–∞–µ–º –≥–µ–Ω–µ—Ä–∞—Ü–∏—é
```

### 6.2 –ò–∑–º–µ–Ω–∏—Ç—å —Ç–æ—á–∫—É –≤—Ö–æ–¥–∞

```typescript
// –í photo handler, –ø–æ—Å–ª–µ –∑–∞–≥—Ä—É–∑–∫–∏ —Ñ–æ—Ç–æ:
if (useStylesV2(telegramId)) {
  // –ù–æ–≤—ã–π UI: –≥—Ä—É–ø–ø—ã ‚Üí –ø–æ–¥—Å—Ç–∏–ª–∏ –∏–∑ style_presets_v2
  await sendStyleGroupsKeyboard(ctx, user, session);
} else {
  // –°—Ç–∞—Ä—ã–π UI: –ø–ª–æ—Å–∫–∏–π —Å–ø–∏—Å–æ–∫ –∏–∑ style_presets (–±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π!)
  await sendStyleKeyboard(ctx, user, session);
}
```

### 6.3 –ò–∑–æ–ª—è—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö

```typescript
// –î–ª—è v2 –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π:
// - –ì—Ä—É–ø–ø—ã –∏–∑ style_groups
// - –ü–æ–¥—Å—Ç–∏–ª–∏ –∏–∑ style_presets_v2

// –î–ª—è –æ–±—ã—á–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π:
// - –°—Ç–∏–ª–∏ –∏–∑ style_presets (–∫–∞–∫ —Å–µ–π—á–∞—Å, –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π)

// Worker –ø–æ–ª—É—á–∞–µ—Ç style_id –∏ —Ä–∞–±–æ—Ç–∞–µ—Ç –æ–¥–∏–Ω–∞–∫–æ–≤–æ –¥–ª—è –æ–±–æ–∏—Ö —Å–ª—É—á–∞–µ–≤
// prompt_hint –±–µ—Ä—ë—Ç—Å—è –∏–∑ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–µ–π —Ç–∞–±–ª–∏—Ü—ã
```

---

## 7. –¢–µ–∫—Å—Ç—ã

```typescript
"style.select_group": {
  ru: "–í—ã–±–µ—Ä–∏ –∫–∞—Ç–µ–≥–æ—Ä–∏—é —Å—Ç–∏–ª—è:",
  en: "Choose style category:"
},
"style.select_substyle": {
  ru: "{emoji} {name} ‚Äî –≤—ã–±–µ—Ä–∏ —Å—Ç–∏–ª—å:",
  en: "{emoji} {name} ‚Äî choose style:"
},
"style.custom_prompt": {
  ru: "‚úçÔ∏è –û–ø–∏—à–∏ –∂–µ–ª–∞–µ–º—ã–π —Å—Ç–∏–ª—å:\n\n–ù–∞–ø—Ä–∏–º–µ—Ä:\n‚Ä¢ –≤ —Å—Ç–∏–ª–µ –∫–æ–º–∏–∫—Å–æ–≤ Marvel\n‚Ä¢ –∫–∞–∫ –ø–µ—Ä—Å–æ–Ω–∞–∂ –ù–∞—Ä—É—Ç–æ\n‚Ä¢ –≤ —Å—Ç–∏–ª–µ —Å–æ–≤–µ—Ç—Å–∫–æ–≥–æ –ø–ª–∞–∫–∞—Ç–∞\n‚Ä¢ –ø–∏–∫—Å–µ–ª—å–Ω—ã–π —Ä–µ—Ç—Ä–æ-—Å—Ç–∏–ª—å",
  en: "‚úçÔ∏è Describe the style you want:\n\nExamples:\n‚Ä¢ Marvel comics style\n‚Ä¢ like a Naruto character\n‚Ä¢ Soviet poster style\n‚Ä¢ pixel retro style"
},
"btn.custom_style": {
  ru: "‚úçÔ∏è –°–≤–æ–π —Å—Ç–∏–ª—å",
  en: "‚úçÔ∏è Custom style"
},
"btn.back_to_groups": {
  ru: "‚¨ÖÔ∏è –ù–∞–∑–∞–¥",
  en: "‚¨ÖÔ∏è Back"
}
```

---

## 8. –ê–Ω–∞–ª–∏—Ç–∏–∫–∞

```sql
-- –ü–æ–ø—É–ª—è—Ä–Ω–æ—Å—Ç—å –≥—Ä—É–ø–ø
SELECT selected_style_group, COUNT(*) 
FROM sessions 
WHERE selected_style_group IS NOT NULL 
GROUP BY selected_style_group 
ORDER BY count DESC;

-- –ö–æ–Ω–≤–µ—Ä—Å–∏—è –≥—Ä—É–ø–ø–∞ ‚Üí –ø–æ–¥—Å—Ç–∏–ª—å
SELECT 
  selected_style_group,
  COUNT(*) FILTER (WHERE selected_style_id IS NOT NULL) as completed,
  COUNT(*) as started,
  ROUND(100.0 * COUNT(*) FILTER (WHERE selected_style_id IS NOT NULL) / COUNT(*), 1) as conversion
FROM sessions
WHERE selected_style_group IS NOT NULL
GROUP BY selected_style_group;
```

---

## 9. Checklist

### –§–∞–∑–∞ 1: –ë–î
- [x] –ú–∏–≥—Ä–∞—Ü–∏—è `036_style_groups.sql` ‚Äî —Å–æ–∑–¥–∞—Ç—å `style_groups`
- [x] –ú–∏–≥—Ä–∞—Ü–∏—è `036_style_groups.sql` ‚Äî —Å–æ–∑–¥–∞—Ç—å `style_presets_v2` (–æ—Ç–¥–µ–ª—å–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞!)
- [x] –í—Å—Ç–∞–≤–∏—Ç—å –≥—Ä—É–ø–ø—ã –≤ `style_groups`
- [x] –í—Å—Ç–∞–≤–∏—Ç—å –ø–æ–¥—Å—Ç–∏–ª–∏ –≤ `style_presets_v2`
- [x] **–ù–ï —Ç—Ä–æ–≥–∞—Ç—å** —Å—É—â–µ—Å—Ç–≤—É—é—â—É—é `style_presets`

### –§–∞–∑–∞ 2: –ö–æ–¥
- [x] Feature flag –≤ config
- [x] –•–µ–ª–ø–µ—Ä `useStylesV2()`
- [x] –§—É–Ω–∫—Ü–∏—è `sendStyleGroupsKeyboard()`
- [x] –§—É–Ω–∫—Ü–∏—è `sendSubstylesKeyboard()`
- [x] –•–µ–Ω–¥–ª–µ—Ä `style_group:*`
- [x] –•–µ–Ω–¥–ª–µ—Ä `style_v2:*`
- [x] –•–µ–Ω–¥–ª–µ—Ä `style_groups_back`
- [x] –•–µ–Ω–¥–ª–µ—Ä `style_custom_v2` (–∫–Ω–æ–ø–∫–∞ ‚Üí –∑–∞–ø—Ä–æ—Å —Ç–µ–∫—Å—Ç–∞)
- [x] –û–±—Ä–∞–±–æ—Ç–∫–∞ —Ç–µ–∫—Å—Ç–∞ –¥–ª—è custom —Å—Ç–∏–ª—è (state: `wait_custom_style_v2`)
- [x] –ò–∑–º–µ–Ω–∏—Ç—å photo handler

### –§–∞–∑–∞ 3: –¢–µ—Å—Ç
- [ ] –¢–µ—Å—Ç –Ω–∞ —Å–≤–æ—ë–º –∞–∫–∫–∞—É–Ω—Ç–µ
- [ ] –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –≤—Å–µ –≥—Ä—É–ø–ø—ã
- [ ] –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –≥–µ–Ω–µ—Ä–∞—Ü–∏—é –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –ø–æ–¥—Å—Ç–∏–ª—è
- [ ] –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∫–Ω–æ–ø–∫—É "–ù–∞–∑–∞–¥"
- [ ] –ü—Ä–æ–≤–µ—Ä–∏—Ç—å "–°–≤–æ–π —Å—Ç–∏–ª—å" (custom)

### –§–∞–∑–∞ 4: –†–∞—Å–∫–∞—Ç–∫–∞
- [ ] –î–æ–±–∞–≤–∏—Ç—å –µ—â–µ —Ç–µ—Å—Ç–æ–≤—ã—Ö —é–∑–µ—Ä–æ–≤
- [ ] –°–æ–±—Ä–∞—Ç—å —Ñ–∏–¥–±–µ–∫
- [ ] –í–∫–ª—é—á–∏—Ç—å –¥–ª—è –≤—Å–µ—Ö (—É–±—Ä–∞—Ç—å feature flag)

---

## 10. –†–∏—Å–∫–∏

| –ü–æ–¥—Å—Ç–∏–ª—å | –†–∏—Å–∫ | –ú–∏—Ç–∏–≥–∞—Ü–∏—è |
|----------|------|-----------|
| `tv_*` | –ê–≤—Ç–æ—Ä—Å–∫–∏–µ –ø—Ä–∞–≤–∞ | –ò—Å–ø–æ–ª—å–∑—É–µ–º "–≤ —Å—Ç–∏–ª–µ", –±–µ–∑ –ø–µ—Ä—Å–æ–Ω–∞–∂–µ–π |
| `ru_love_is` | Trademark | –î–µ–ª–∞–µ–º "–≤ —Å—Ç–∏–ª–µ", –Ω–µ –∫–æ–ø–∏—Ä—É–µ–º |
| `ru_gopnik` | –ú–æ–∂–µ—Ç –æ—Å–∫–æ—Ä–±–∏—Ç—å | –ü–æ–∑–∏—Ü–∏–æ–Ω–∏—Ä—É–µ–º –∫–∞–∫ –º–µ–º-–∫—É–ª—å—Ç—É—Ä—É |
| `anime_*` | –ù–∏–∑–∫–∏–π | –û–±—â–∏–π —Å—Ç–∏–ª—å –±–µ–∑ IP |

---

## –ò—Å—Ç–æ—á–Ω–∏–∫ –¥–∞–Ω–Ω—ã—Ö

–ê–Ω–∞–ª–∏–∑ –æ—Å–Ω–æ–≤–∞–Ω –Ω–∞ Wordstat –∑–∞–ø—Ä–æ—Å–∞—Ö "—Å—Ç–∏–∫–µ—Ä—ã —Ç–≥" –∑–∞ –ø–µ—Ä–∏–æ–¥ 05.01.2026 ‚Äî 05.02.2026 (—Ñ–∞–π–ª `wordstat_top_queries.csv`).

–¢–æ–ø-–∑–∞–ø—Ä–æ—Å—ã –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º:
- –ê–Ω–∏–º–µ: 8,460+
- –ú–µ–º—ã: 11,442+
- –ú–∏–ª—ã–µ/–∫–æ—Ç–∏–∫–∏: 7,000+
- –õ—é–±–æ–≤—å/—Ä–æ–º–∞–Ω—Ç–∏–∫–∞: 15,000+
- TV/—Å–µ—Ä–∏–∞–ª—ã: 5,000+
- –†—É—Å—Å–∫–∞—è –∫—É–ª—å—Ç—É—Ä–∞: 2,500+
