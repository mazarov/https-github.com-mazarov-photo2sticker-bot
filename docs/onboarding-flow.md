# Guided Onboarding Flow

## –¶–µ–ª—å
–ü–æ–∫–∞–∑–∞—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é –ø–æ–ª–Ω—ã–π —Ü–∏–∫–ª —Å–æ–∑–¥–∞–Ω–∏—è —Å—Ç–∏–∫–µ—Ä–∞: –±–∞–∑–æ–≤—ã–π —Å—Ç–∏–∫–µ—Ä ‚Üí —ç–º–æ—Ü–∏—è ‚Üí –ø–æ–Ω–∏–º–∞–Ω–∏–µ —Ü–µ–Ω–Ω–æ—Å—Ç–∏ ‚Üí –ø–æ–∫—É–ø–∫–∞.

## –°—Ü–µ–Ω–∞—Ä–∏–π (User Journey)

### –®–∞–≥ 1: –ü–µ—Ä–≤—ã–π —Å—Ç–∏–∫–µ—Ä (–ë–ï–°–ü–õ–ê–¢–ù–û)
```
–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å: /start
–ë–æ—Ç: "–ü—Ä–∏–≤–µ—Ç! –û—Ç–ø—Ä–∞–≤—å —Ñ–æ—Ç–æ ‚Äî —è —Å–¥–µ–ª–∞—é –∏–∑ –Ω–µ–≥–æ —Å—Ç–∏–∫–µ—Ä üé®"

–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å: [–æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —Ñ–æ—Ç–æ]
–ë–æ—Ç: "–í—ã–±–µ—Ä–∏ —Å—Ç–∏–ª—å:" [–∫–Ω–æ–ø–∫–∏ —Å—Ç–∏–ª–µ–π]

–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å: [–≤—ã–±–∏—Ä–∞–µ—Ç "–ê–Ω–∏–º–µ"]
–ë–æ—Ç: "‚è≥ –°–æ–∑–¥–∞—é —Å—Ç–∏–∫–µ—Ä..."
–ë–æ—Ç: [–æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —Å—Ç–∏–∫–µ—Ä]
     "–í–æ—Ç —Ç–≤–æ–π –ø–µ—Ä–≤—ã–π —Å—Ç–∏–∫–µ—Ä! üéâ"
```

### –®–∞–≥ 2: –ü—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ —ç–º–æ—Ü–∏–∏ (–ë–ï–°–ü–õ–ê–¢–ù–û)
```
–ë–æ—Ç: "–ê —Ç–µ–ø–µ—Ä—å –¥–∞–≤–∞–π –æ–∂–∏–≤–∏–º –µ–≥–æ! –í—ã–±–µ—Ä–∏ —ç–º–æ—Ü–∏—é:"
     [üòÇ –°–º–µ—Ö] [üòé –ö—Ä—É—Ç–æ–π] [üò¢ –ì—Ä—É—Å—Ç–Ω—ã–π] [ü§î –î—É–º–∞–µ—Ç]
     [–ü—Ä–æ–ø—É—Å—Ç–∏—Ç—å ‚Üí]

–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å: [–≤—ã–±–∏—Ä–∞–µ—Ç "üòÇ –°–º–µ—Ö"]
–ë–æ—Ç: "‚è≥ –î–æ–±–∞–≤–ª—è—é —ç–º–æ—Ü–∏—é..."
–ë–æ—Ç: [–æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —Å—Ç–∏–∫–µ—Ä —Å —ç–º–æ—Ü–∏–µ–π]
     "–°–º–æ—Ç—Ä–∏ –∫–∞–∫ –∫—Ä—É—Ç–æ! –¢–µ–ø–µ—Ä—å —Å—Ç–∏–∫–µ—Ä –∂–∏–≤–æ–π üòÇ"
```

### –®–∞–≥ 3: –ü–æ–∫–∞–∑ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–µ–π (–±–µ–∑ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏)
```
–ë–æ—Ç: "–ï—â—ë –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –¥–≤–∏–∂–µ–Ω–∏–µ –∏ —Ç–µ–∫—Å—Ç:
      üèÉ –ë–µ–≥, —Ç–∞–Ω–µ—Ü, –ø—Ä—ã–∂–æ–∫
      üí¨ –ù–∞–¥–ø–∏—Å—å –Ω–∞ —Å—Ç–∏–∫–µ—Ä–µ
      
      –•–æ—á–µ—à—å —Å–æ–∑–¥–∞—Ç—å –µ—â—ë —Å—Ç–∏–∫–µ—Ä—ã?"
      
     [üõí –ö—É–ø–∏—Ç—å –∫—Ä–µ–¥–∏—Ç—ã] [üì∑ –ù–æ–≤–æ–µ —Ñ–æ—Ç–æ]
```

### –®–∞–≥ 4: –ü–æ–∫—É–ø–∫–∞ –∏–ª–∏ –Ω–æ–≤–æ–µ —Ñ–æ—Ç–æ
```
–ï—Å–ª–∏ "–ö—É–ø–∏—Ç—å –∫—Ä–µ–¥–∏—Ç—ã":
  ‚Üí –ø–æ–∫–∞–∑–∞—Ç—å —Ç–∞—Ä–∏—Ñ—ã

–ï—Å–ª–∏ "–ù–æ–≤–æ–µ —Ñ–æ—Ç–æ":
  –ë–æ—Ç: "–û—Ç–ø—Ä–∞–≤—å —Ñ–æ—Ç–æ ‚Äî —Å–¥–µ–ª–∞–µ–º –Ω–æ–≤—ã–π —Å—Ç–∏–∫–µ—Ä!"
  ‚Üí —É–∂–µ –ø–ª–∞—Ç–Ω–æ (–∫—Ä–µ–¥–∏—Ç—ã –Ω—É–∂–Ω—ã)
```

## –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

### 1. –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö

```sql
ALTER TABLE users ADD COLUMN IF NOT EXISTS onboarding_step int DEFAULT 0;

-- 0 = –Ω–µ –Ω–∞—á–∞—Ç
-- 1 = –ø–µ—Ä–≤—ã–π —Å—Ç–∏–∫–µ—Ä —Å–æ–∑–¥–∞–Ω, –∂–¥—ë–º —ç–º–æ—Ü–∏—é
-- 2 = —ç–º–æ—Ü–∏—è —Å–æ–∑–¥–∞–Ω–∞, –æ–Ω–±–æ—Ä–¥–∏–Ω–≥ –∑–∞–≤–µ—Ä—à—ë–Ω
-- 99 = –æ–Ω–±–æ—Ä–¥–∏–Ω–≥ –ø—Ä–æ–ø—É—â–µ–Ω
```

### 2. –ë–µ—Å–ø–ª–∞—Ç–Ω—ã–µ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏

| –®–∞–≥ | –¢–∏–ø | –ë–µ—Å–ø–ª–∞—Ç–Ω–æ? |
|-----|-----|------------|
| 1 | –ë–∞–∑–æ–≤—ã–π —Å—Ç–∏–∫–µ—Ä (—Å—Ç–∏–ª—å) | ‚úÖ –î–∞ |
| 2 | –≠–º–æ—Ü–∏—è –∫ –ø–µ—Ä–≤–æ–º—É —Å—Ç–∏–∫–µ—Ä—É | ‚úÖ –î–∞ |
| 3+ | –õ—é–±–∞—è –≥–µ–Ω–µ—Ä–∞—Ü–∏—è | ‚ùå –ù—É–∂–Ω—ã –∫—Ä–µ–¥–∏—Ç—ã |

**–ò—Ç–æ–≥–æ:** 2 –±–µ—Å–ø–ª–∞—Ç–Ω—ã—Ö –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –¥–ª—è –Ω–æ–≤—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π.

### 3. –õ–æ–≥–∏–∫–∞ –≤ –∫–æ–¥–µ

**–ü–æ—Å–ª–µ –ø–µ—Ä–≤–æ–π –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ (`onboarding_step = 0 ‚Üí 1`):**
```typescript
if (user.onboarding_step === 0) {
  // –ü–æ–∫–∞–∑–∞—Ç—å —Å–ø–µ—Ü–∏–∞–ª—å–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ —Å —ç–º–æ—Ü–∏—è–º–∏
  await ctx.reply("–ê —Ç–µ–ø–µ—Ä—å –æ–∂–∏–≤–∏–º —Å—Ç–∏–∫–µ—Ä! –í—ã–±–µ—Ä–∏ —ç–º–æ—Ü–∏—é:", 
    emotionOnboardingKeyboard);
  
  await updateUser(user.id, { onboarding_step: 1 });
}
```

**–ü–æ—Å–ª–µ –≤—Ç–æ—Ä–æ–π –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ (`onboarding_step = 1 ‚Üí 2`):**
```typescript
if (user.onboarding_step === 1) {
  await ctx.reply("–ö—Ä—É—Ç–æ! –¢–µ–ø–µ—Ä—å —Ç—ã –∑–Ω–∞–µ—à—å –∫–∞–∫ –¥–µ–ª–∞—Ç—å –∂–∏–≤—ã–µ —Å—Ç–∏–∫–µ—Ä—ã...");
  await updateUser(user.id, { onboarding_step: 2 });
}
```

**–ü—Ä–æ–≤–µ—Ä–∫–∞ –±–µ—Å–ø–ª–∞—Ç–Ω–æ—Å—Ç–∏:**
```typescript
const isOnboardingFree = 
  (user.onboarding_step === 0) || // –ø–µ—Ä–≤—ã–π —Å—Ç–∏–∫–µ—Ä
  (user.onboarding_step === 1 && generationType === "emotion"); // —ç–º–æ—Ü–∏—è –∫ –ø–µ—Ä–≤–æ–º—É
```

### 4. UI/UX

**–ö–ª–∞–≤–∏–∞—Ç—É—Ä–∞ —ç–º–æ—Ü–∏–π –¥–ª—è –æ–Ω–±–æ—Ä–¥–∏–Ω–≥–∞:**
- 4-5 –ø–æ–ø—É–ª—è—Ä–Ω—ã—Ö —ç–º–æ—Ü–∏–π
- –ö–Ω–æ–ø–∫–∞ "–ü—Ä–æ–ø—É—Å—Ç–∏—Ç—å"

**–¢–µ–∫—Å—Ç—ã:**
```
onboarding.after_first_sticker: "–í–æ—Ç —Ç–≤–æ–π –ø–µ—Ä–≤—ã–π —Å—Ç–∏–∫–µ—Ä! üéâ\n\n–ê —Ç–µ–ø–µ—Ä—å –¥–∞–≤–∞–π –æ–∂–∏–≤–∏–º –µ–≥–æ ‚Äî –≤—ã–±–µ—Ä–∏ —ç–º–æ—Ü–∏—é:"

onboarding.after_emotion: "–°–º–æ—Ç—Ä–∏ –∫–∞–∫ –∫—Ä—É—Ç–æ! üòÇ\n\n–¢–µ–ø–µ—Ä—å —Ç—ã —É–º–µ–µ—à—å —Å–æ–∑–¥–∞–≤–∞—Ç—å –∂–∏–≤—ã–µ —Å—Ç–∏–∫–µ—Ä—ã.\n\n–ï—â—ë –º–æ–∂–Ω–æ:\nüèÉ –î–æ–±–∞–≤–∏—Ç—å –¥–≤–∏–∂–µ–Ω–∏–µ\nüí¨ –ù–∞–ø–∏—Å–∞—Ç—å —Ç–µ–∫—Å—Ç\n\n–ì–æ—Ç–æ–≤ —Å–æ–∑–¥–∞—Ç—å –±–æ–ª—å—à–µ?"

onboarding.skip: "–•–æ—Ä–æ—à–æ! –ö–æ–≥–¥–∞ –∑–∞—Ö–æ—á–µ—à—å –¥–æ–±–∞–≤–∏—Ç—å —ç–º–æ—Ü–∏—é ‚Äî –Ω–∞–∂–º–∏ –∫–Ω–æ–ø–∫—É –ø–æ–¥ —Å—Ç–∏–∫–µ—Ä–æ–º."
```

### 5. –î–∏–∞–≥—Ä–∞–º–º–∞ —Å–æ—Å—Ç–æ—è–Ω–∏–π

```
[–ù–æ–≤—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å]
        ‚Üì
   onboarding_step = 0
        ‚Üì
[–§–æ—Ç–æ ‚Üí –°—Ç–∏–ª—å ‚Üí –°—Ç–∏–∫–µ—Ä] ‚Üê –ë–ï–°–ü–õ–ê–¢–ù–û
        ‚Üì
   onboarding_step = 1
        ‚Üì
   ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îê
   ‚Üì         ‚Üì
[–≠–º–æ—Ü–∏—è]  [–ü—Ä–æ–ø—É—Å—Ç–∏—Ç—å]
   ‚Üì         ‚Üì
–ë–ï–°–ü–õ–ê–¢–ù–û   onboarding_step = 99
   ‚Üì
onboarding_step = 2
   ‚Üì
[–û–±—ã—á–Ω—ã–π —Ä–µ–∂–∏–º ‚Äî –Ω—É–∂–Ω—ã –∫—Ä–µ–¥–∏—Ç—ã]
```

## –ß–µ–∫–ª–∏—Å—Ç

- [ ] –ú–∏–≥—Ä–∞—Ü–∏—è: –¥–æ–±–∞–≤–∏—Ç—å `onboarding_step` –≤ `users`
- [ ] –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å `onboarding_step = 99` –¥–ª—è —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- [ ] –ò–∑–º–µ–Ω–∏—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É –±–µ—Å–ø–ª–∞—Ç–Ω–æ—Å—Ç–∏ –≤ `startGeneration`
- [ ] –ò–∑–º–µ–Ω–∏—Ç—å –ª–æ–≥–∏–∫—É –ø–æ—Å–ª–µ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –≤ `worker.ts`
- [ ] –î–æ–±–∞–≤–∏—Ç—å –æ–Ω–±–æ—Ä–¥–∏–Ω–≥-–∫–ª–∞–≤–∏–∞—Ç—É—Ä—É —ç–º–æ—Ü–∏–π
- [ ] –î–æ–±–∞–≤–∏—Ç—å —Ç–µ–∫—Å—Ç—ã –æ–Ω–±–æ—Ä–¥–∏–Ω–≥–∞
- [ ] –î–æ–±–∞–≤–∏—Ç—å –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ "–ü—Ä–æ–ø—É—Å—Ç–∏—Ç—å"
