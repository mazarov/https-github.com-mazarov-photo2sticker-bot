# –û–Ω–±–æ—Ä–¥–∏–Ω–≥: best practice workflow + –ø–æ–ª–Ω—ã–µ –∫–Ω–æ–ø–∫–∏ –ø–æ—Å–ª–µ –ø–µ—Ä–≤–æ–π –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏

**–î–∞—Ç–∞:** 2026-02-12
**–°—Ç–∞—Ç—É—Å:** –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ (test)

---

## –ü—Ä–æ–±–ª–µ–º–∞

1. **AI-–∞–≥–µ–Ω—Ç –Ω–µ –æ–±—ä—è—Å–Ω—è–µ—Ç best practice** ‚Äî –Ω–æ–≤—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –Ω–µ –∑–Ω–∞—é—Ç, —á—Ç–æ –∏–∑ –æ–¥–Ω–æ–≥–æ —Å—Ç–∏–∫–µ—Ä–∞ –º–æ–∂–Ω–æ –±—ã—Å—Ç—Ä–æ —Å–æ–∑–¥–∞—Ç—å —Ü–µ–ª—ã–π –ø–∞–∫ —á–µ—Ä–µ–∑ –∫–Ω–æ–ø–∫–∏
2. **–ü–æ—Å–ª–µ –ø–µ—Ä–≤–æ–π –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ "–î–æ–±–∞–≤–∏—Ç—å –≤ –ø–∞–∫"** ‚Äî –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –≤–∏–¥–∏—Ç –¥—Ä—É–≥–∏–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ (—ç–º–æ—Ü–∏—è, –¥–≤–∏–∂–µ–Ω–∏–µ, —Ç–µ–∫—Å—Ç, –æ–±–≤–æ–¥–∫–∞, –∏–¥–µ–∏ –¥–ª—è –ø–∞–∫–∞)
3. **Guided emotion step (—à–∞–≥ 1 –æ–Ω–±–æ—Ä–¥–∏–Ω–≥–∞)** ‚Äî –∑–∞—Å—Ç–∞–≤–ª—è–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –ø—Ä–æ–π—Ç–∏ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π –ø—É—Ç—å, –≤–º–µ—Å—Ç–æ —Ç–æ–≥–æ —á—Ç–æ–±—ã –¥–∞—Ç—å —Å–≤–æ–±–æ–¥—É –≤—ã–±–æ—Ä–∞
4. **–ö–Ω–æ–ø–∫–∞ "–ê—Å—Å–∏—Å—Ç–µ–Ω—Ç" –≤ –ø–æ—Å—Ç-–≥–µ–Ω–µ—Ä–∞—Ü–∏–æ–Ω–Ω—ã—Ö –∫–Ω–æ–ø–∫–∞—Ö** ‚Äî –¥—É–±–ª–∏—Ä—É–µ—Ç –Ω–∏–∂–Ω–µ–µ –º–µ–Ω—é, –∑–∞–Ω–∏–º–∞–µ—Ç –º–µ—Å—Ç–æ

## Best Practice (—á—Ç–æ –æ–±—ä—è—Å–Ω—è–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é)

```
–°–≥–µ–Ω–µ—Ä–∏—Ä—É–π –æ–¥–∏–Ω —Å—Ç–∏–∫–µ—Ä ‚Üí –∏—Å–ø–æ–ª—å–∑—É–π –∫–Ω–æ–ø–∫–∏ –ø–æ–¥ –Ω–∏–º ‚Üí —Å–æ–∑–¥–∞–π —Ü–µ–ª—ã–π —Å—Ç–∏–∫–µ—Ä–ø–∞–∫
```

–ö–Ω–æ–ø–∫–∏ –ø–æ–¥ —Å—Ç–∏–∫–µ—Ä–æ–º:
- üòä –°–º–µ–Ω–∏—Ç—å —ç–º–æ—Ü–∏—é ‚Äî –±—ã—Å—Ç—Ä–æ –ø–æ–ª—É—á–∏—Ç—å –≤–∞—Ä–∏–∞—Ü–∏—é —Å –¥—Ä—É–≥–∏–º –≤—ã—Ä–∞–∂–µ–Ω–∏–µ–º
- üèÉ –î–æ–±–∞–≤–∏—Ç—å –¥–≤–∏–∂–µ–Ω–∏–µ ‚Äî –∞–Ω–∏–º–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Å—Ç–∏–∫–µ—Ä
- üî≤ –û–±–≤–æ–¥–∫–∞ ‚Äî –¥–æ–±–∞–≤–∏—Ç—å/—É–±—Ä–∞—Ç—å —Ä–∞–º–∫—É
- üí¨ –¢–µ–∫—Å—Ç –Ω–∞ —Å—Ç–∏–∫–µ—Ä–µ ‚Äî –Ω–∞–¥–ø–∏—Å—å –ø–æ–≤–µ—Ä—Ö —Å—Ç–∏–∫–µ—Ä–∞
- üí° –ò–¥–µ–∏ –¥–ª—è –ø–∞–∫–∞ ‚Äî –ò–ò –ø—Ä–µ–¥–ª–æ–∂–∏—Ç —Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –≤–∞—Ä–∏–∞–Ω—Ç—ã

–≠—Ç–æ **–∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ –±—ã—Å—Ç—Ä–µ–µ**, —á–µ–º —Å–æ–∑–¥–∞–≤–∞—Ç—å –∫–∞–∂–¥—ã–π —Å—Ç–∏–∫–µ—Ä —Å –Ω—É–ª—è —á–µ—Ä–µ–∑ –Ω–æ–≤–æ–≥–æ –∞—Å—Å–∏—Å—Ç–µ–Ω—Ç–∞.

---

## –ò–∑–º–µ–Ω–µ–Ω–∏—è

### 1. AI –ø—Ä–æ–º–ø—Ç ‚Äî best practice –≤ onboarding —Å–µ–∫—Ü–∏–∏

**–§–∞–π–ª:** `src/lib/ai-chat.ts`, `buildSystemPrompt()`, —Å–µ–∫—Ü–∏—è Onboarding

**–ë—ã–ª–æ:** 3 —Å–æ–≤–µ—Ç–∞ (–ø–∞—Ä–∞–º–µ—Ç—Ä—ã, —Å—Ç–∏–ª—å, –ø–æ—Å—Ç-–≥–µ–Ω–µ—Ä–∞—Ü–∏—è), –ø–æ—Å—Ç-–≥–µ–Ω–µ—Ä–∞—Ü–∏—è —É–ø–æ–º–∏–Ω–∞–ª–∞—Å—å –≤—Å–∫–æ–ª—å–∑—å.

**–°—Ç–∞–ª–æ:** –∑–∞–º–µ–Ω—ë–Ω –ø—É–Ω–∫—Ç 3 –Ω–∞ –æ–±—ä—è—Å–Ω–µ–Ω–∏–µ best practice workflow:

```
3. BEST PRACTICE ‚Äî explain the workflow (mention this ONCE, naturally):
   Generate one sticker ‚Üí use buttons underneath to create variations.
   
   RU: "–õ–∞–π—Ñ—Ö–∞–∫: —Å–Ω–∞—á–∞–ª–∞ —Å–≥–µ–Ω–µ—Ä–∏—Ä—É–π –æ–¥–∏–Ω —Å—Ç–∏–∫–µ—Ä, –∞ –ø–æ—Ç–æ–º –ø–æ–¥ –Ω–∏–º –±—É–¥—É—Ç –∫–Ω–æ–ø–∫–∏ ‚Äî 
        —Å–º–µ–Ω–∏—Ç—å —ç–º–æ—Ü–∏—é, –¥–æ–±–∞–≤–∏—Ç—å –¥–≤–∏–∂–µ–Ω–∏–µ, —Ç–µ–∫—Å—Ç, –æ–±–≤–æ–¥–∫—É. 
        –¢–∞–∫ –∏–∑ –æ–¥–Ω–æ–≥–æ —Ñ–æ—Ç–æ –º–æ–∂–Ω–æ –±—ã—Å—Ç—Ä–æ —Å–¥–µ–ª–∞—Ç—å —Ü–µ–ª—ã–π —Å—Ç–∏–∫–µ—Ä–ø–∞–∫!"
```

### 2. –ü–æ–ª–Ω—ã–π –Ω–∞–±–æ—Ä –∫–Ω–æ–ø–æ–∫ –ø–æ—Å–ª–µ –ø–µ—Ä–≤–æ–π –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏

**–§–∞–π–ª:** `src/worker.ts`

**–ë—ã–ª–æ:**
- `onboarding_step = 0`: —Å—Ç–∏–∫–µ—Ä ‚Üí —Ç–æ–ª—å–∫–æ –∫–Ω–æ–ø–∫–∞ "–î–æ–±–∞–≤–∏—Ç—å –≤ –ø–∞–∫" ‚Üí —Å–æ–æ–±—â–µ–Ω–∏–µ —Å 4 —ç–º–æ—Ü–∏—è–º–∏
- `onboarding_step = 1`: —Å—Ç–∏–∫–µ—Ä —ç–º–æ—Ü–∏–∏ ‚Üí –ø–æ–ª–Ω—ã–µ –∫–Ω–æ–ø–∫–∏ ‚Üí "–ï—â—ë –º–æ–∂–Ω–æ: –¥–≤–∏–∂–µ–Ω–∏–µ, —Ç–µ–∫—Å—Ç"
- `onboarding_step = 2`: –æ–±—ã—á–Ω—ã–π flow

**–°—Ç–∞–ª–æ:**
- `onboarding_step = 0`: —Å—Ç–∏–∫–µ—Ä ‚Üí **–ø–æ–ª–Ω—ã–π –Ω–∞–±–æ—Ä –∫–Ω–æ–ø–æ–∫** ‚Üí —Å–æ–æ–±—â–µ–Ω–∏–µ —Å –æ–±—ä—è—Å–Ω–µ–Ω–∏–µ–º –≤—Å–µ—Ö –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–µ–π ‚Üí `onboarding_step = 2`
- Guided emotion step **—É–±—Ä–∞–Ω** ‚Äî –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å–∞–º –≤—ã–±–∏—Ä–∞–µ—Ç —á—Ç–æ –¥–µ–ª–∞—Ç—å –¥–∞–ª—å—à–µ
- `onboarding_step = 2`: –æ–±—ã—á–Ω—ã–π flow (–±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π)

–°–æ–æ–±—â–µ–Ω–∏–µ –ø–æ—Å–ª–µ –ø–µ—Ä–≤–æ–≥–æ —Å—Ç–∏–∫–µ—Ä–∞:
```
üéâ –í–æ—Ç —Ç–≤–æ–π –ø–µ—Ä–≤—ã–π —Å—Ç–∏–∫–µ—Ä!

üí° –õ–∞–π—Ñ—Ö–∞–∫: –∏—Å–ø–æ–ª—å–∑—É–π –∫–Ω–æ–ø–∫–∏ –ø–æ–¥ —Å—Ç–∏–∫–µ—Ä–æ–º, —á—Ç–æ–±—ã –±—ã—Å—Ç—Ä–æ —Å–¥–µ–ª–∞—Ç—å —Ü–µ–ª—ã–π —Å—Ç–∏–∫–µ—Ä–ø–∞–∫:

üòä –°–º–µ–Ω–∏—Ç—å —ç–º–æ—Ü–∏—é
üèÉ –î–æ–±–∞–≤–∏—Ç—å –¥–≤–∏–∂–µ–Ω–∏–µ
üî≤ –û–±–≤–æ–¥–∫–∞
üí¨ –¢–µ–∫—Å—Ç –Ω–∞ —Å—Ç–∏–∫–µ—Ä–µ
üí° –ò–¥–µ–∏ –¥–ª—è –ø–∞–∫–∞ ‚Äî –ò–ò –ø—Ä–µ–¥–ª–æ–∂–∏—Ç –≤–∞—Ä–∏–∞–Ω—Ç—ã!

–¢–∞–∫ –∏–∑ –æ–¥–Ω–æ–≥–æ —Ñ–æ—Ç–æ –º–æ–∂–Ω–æ —Å–æ–∑–¥–∞—Ç—å 10+ —Å—Ç–∏–∫–µ—Ä–æ–≤ üöÄ
```

### 3. –£–±—Ä–∞–Ω–∞ –∫–Ω–æ–ø–∫–∞ "–ê—Å—Å–∏—Å—Ç–µ–Ω—Ç" –∏–∑ –ø–æ—Å—Ç-–≥–µ–Ω–µ—Ä–∞—Ü–∏–æ–Ω–Ω—ã—Ö –∫–Ω–æ–ø–æ–∫

**–§–∞–π–ª—ã:** `src/worker.ts`, `src/index.ts` (`buildStickerButtons`)

**–ë—ã–ª–æ (layout):**
```
[–î–æ–±–∞–≤–∏—Ç—å –≤ –ø–∞–∫]
[ü§ñ –ê—Å—Å–∏—Å—Ç–µ–Ω—Ç] [–°–º–µ–Ω–∏—Ç—å —ç–º–æ—Ü–∏—é]
[–î–≤–∏–∂–µ–Ω–∏–µ] [–û–±–≤–æ–¥–∫–∞]
[–î–æ–±–∞–≤–∏—Ç—å —Ç–µ–∫—Å—Ç]
[–ò–¥–µ–∏ –¥–ª—è –ø–∞–∫–∞]
```

**–°—Ç–∞–ª–æ (layout):**
```
[–î–æ–±–∞–≤–∏—Ç—å –≤ –ø–∞–∫]
[–°–º–µ–Ω–∏—Ç—å —ç–º–æ—Ü–∏—é] [–î–æ–±–∞–≤–∏—Ç—å –¥–≤–∏–∂–µ–Ω–∏–µ]
[–û–±–≤–æ–¥–∫–∞] [–î–æ–±–∞–≤–∏—Ç—å —Ç–µ–∫—Å—Ç]
[–ò–¥–µ–∏ –¥–ª—è –ø–∞–∫–∞]
```

–ö–Ω–æ–ø–∫–∞ "–ê—Å—Å–∏—Å—Ç–µ–Ω—Ç" –æ—Å—Ç–∞—ë—Ç—Å—è –≤ –Ω–∏–∂–Ω–µ–º –º–µ–Ω—é –±–æ—Ç–∞.

---

## –ó–∞—Ç—Ä–æ–Ω—É—Ç—ã–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã

- ‚úÖ API (`Dockerfile.api`) ‚Äî –ø—Ä–æ–º–ø—Ç, buildStickerButtons
- ‚úÖ Worker (`Dockerfile.worker`) ‚Äî –∫–Ω–æ–ø–∫–∏, –æ–Ω–±–æ—Ä–¥–∏–Ω–≥-—Å–æ–æ–±—â–µ–Ω–∏–µ

---

## –ß–µ–∫–ª–∏—Å—Ç

- [x] AI –ø—Ä–æ–º–ø—Ç: best practice workflow –≤ onboarding —Å–µ–∫—Ü–∏–∏
- [x] Worker: –ø–æ–ª–Ω—ã–π –Ω–∞–±–æ—Ä –∫–Ω–æ–ø–æ–∫ –ø–æ—Å–ª–µ –ø–µ—Ä–≤–æ–π –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏
- [x] Worker: –Ω–æ–≤–æ–µ onboarding-—Å–æ–æ–±—â–µ–Ω–∏–µ (–æ–±—ä—è—Å–Ω–µ–Ω–∏–µ –∫–Ω–æ–ø–æ–∫)
- [x] Worker: —É–±—Ä–∞–Ω guided emotion step, —Å—Ä–∞–∑—É onboarding_step = 2
- [x] Worker + API: —É–±—Ä–∞–Ω–∞ –∫–Ω–æ–ø–∫–∞ "–ê—Å—Å–∏—Å—Ç–µ–Ω—Ç" –∏–∑ –ø–æ—Å—Ç-–≥–µ–Ω–µ—Ä–∞—Ü–∏–æ–Ω–Ω—ã—Ö –∫–Ω–æ–ø–æ–∫
- [x] Worker + API: –ø–µ—Ä–µ–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω layout –∫–Ω–æ–ø–æ–∫ (2 –Ω–∞ —Å—Ç—Ä–æ–∫—É)
- [x] –î–µ–ø–ª–æ–π –Ω–∞ test
- [ ] –¢–µ—Å—Ç: –Ω–æ–≤—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å, –ø—Ä–æ–≤–µ—Ä–∏—Ç—å onboarding flow
- [ ] –¢–µ—Å—Ç: –ø—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ AI –æ–±—ä—è—Å–Ω—è–µ—Ç best practice –ø—Ä–∏ —Å–±–æ—Ä–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤
- [ ] –î–µ–ø–ª–æ–π –Ω–∞ prod
