# Outreach ‚Äî –ø–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é –∏–∑ –∞–ª–µ—Ä—Ç–æ–≤

## –ü—Ä–æ–±–ª–µ–º–∞

–ö–æ–≥–¥–∞ –Ω–æ–≤—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø—Ä–∏—Ö–æ–¥–∏—Ç –∏ –Ω–µ –ø–æ–∫—É–ø–∞–µ—Ç –∫—Ä–µ–¥–∏—Ç—ã ‚Äî –º—ã –Ω–µ –∑–Ω–∞–µ–º –ø–æ—á–µ–º—É.
–•–æ—Ç–∏–º –Ω–∞–ø–∏—Å–∞—Ç—å –µ–º—É –ª–∏—á–Ω–æ–µ –ø–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –∏ —É–∑–Ω–∞—Ç—å –ø—Ä–∏—á–∏–Ω—É.

## –†–µ—à–µ–Ω–∏–µ

**–ü–æ–ª—É–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π outreach**:
1. AI –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –ø–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –Ω–∞ –æ—Å–Ω–æ–≤–µ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
2. –°–æ–æ–±—â–µ–Ω–∏–µ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è –∞–¥–º–∏–Ω—É –≤ –∞–ª–µ—Ä—Ç-–∫–∞–Ω–∞–ª–µ
3. –ê–¥–º–∏–Ω –Ω–∞–∂–∏–º–∞–µ—Ç –∫–Ω–æ–ø–∫—É "–û—Ç–ø—Ä–∞–≤–∏—Ç—å" ‚Äî —Å–æ–æ–±—â–µ–Ω–∏–µ —É—Ö–æ–¥–∏—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é
4. –û—Ç–≤–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è —Å–æ–±–∏—Ä–∞–µ—Ç—Å—è —á–µ—Ä–µ–∑ support –±–æ—Ç –∏ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –≤ –ë–î

## –ü–æ—Ç–æ–∫

```mermaid
sequenceDiagram
    participant USER as –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å
    participant BOT as –û—Å–Ω–æ–≤–Ω–æ–π –±–æ—Ç
    participant AI as AI (gpt-4o-mini)
    participant ALERT as –ê–ª–µ—Ä—Ç-–∫–∞–Ω–∞–ª
    participant ADMIN as –ê–¥–º–∏–Ω
    participant SUPPORT as Support –±–æ—Ç
    participant DB as PostgreSQL

    USER->>BOT: /start
    BOT->>AI: –°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å outreach<br/>(–∏–º—è, —è–∑—ã–∫, UTM, premium, –¥–µ–π—Å—Ç–≤–∏—è)
    AI-->>BOT: –ü–µ—Ä—Å–æ–Ω–∞–ª—å–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
    BOT->>DB: –°–æ—Ö—Ä–∞–Ω–∏—Ç—å outreach (status: draft)
    BOT->>ALERT: üÜï –ù–æ–≤—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å<br/>[üî•-10%] [üî•-15%] [üî•-25%]<br/>üí¨ "–°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ..."<br/>[‚úâÔ∏è –û—Ç–ø—Ä–∞–≤–∏—Ç—å] [üîÑ –ü–µ—Ä–µ–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å]

    ADMIN->>ALERT: –ö–ª–∏–∫ "‚úâÔ∏è –û—Ç–ø—Ä–∞–≤–∏—Ç—å"
    ALERT->>BOT: callback: admin_send_outreach:ID
    BOT->>DB: –û–±–Ω–æ–≤–∏—Ç—å status: sent
    BOT->>USER: –ü–µ—Ä—Å–æ–Ω–∞–ª—å–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ + –∫–Ω–æ–ø–∫–∞ "üí¨ –û—Ç–≤–µ—Ç–∏—Ç—å"
    BOT->>ALERT: ‚úÖ –û—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ @username

    USER->>SUPPORT: –ö–ª–∏–∫ "üí¨ –û—Ç–≤–µ—Ç–∏—Ç—å" ‚Üí deeplink outreach_ID
    SUPPORT->>USER: "–ù–∞–ø–∏—à–∏—Ç–µ –≤–∞—à –æ—Ç–≤–µ—Ç"
    USER->>SUPPORT: "–ú–Ω–µ –ø–æ–∫–∞–∑–∞–ª–æ—Å—å –¥–æ—Ä–æ–≥–æ"
    SUPPORT->>DB: –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –æ—Ç–≤–µ—Ç
    SUPPORT->>ALERT: üí¨ –û—Ç–≤–µ—Ç –æ—Ç @username:<br/>"–ú–Ω–µ –ø–æ–∫–∞–∑–∞–ª–æ—Å—å –¥–æ—Ä–æ–≥–æ"
```

## –î–µ—Ç–∞–ª–∏ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

### 1. –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω–æ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏—è (AI)

**–ö–æ–≥–¥–∞**: —Å—Ä–∞–∑—É –ø—Ä–∏ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –Ω–æ–≤–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (async, –Ω–µ –±–ª–æ–∫–∏—Ä—É–µ—Ç /start).

**–í—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –¥–ª—è AI**:
- –ò–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (`first_name`)
- –Ø–∑—ã–∫ (`language_code`)
- UTM-–∏—Å—Ç–æ—á–Ω–∏–∫ (yandex, google, organic –∏ —Ç.–¥.)
- Premium —Å—Ç–∞—Ç—É—Å
- Username (–µ—Å—Ç—å/–Ω–µ—Ç)

**–°–∏—Å—Ç–µ–º–Ω—ã–π –ø—Ä–æ–º–ø—Ç** (—Ö—Ä–∞–Ω–∏—Ç—Å—è –≤ `bot_texts_new`, –∫–ª—é—á `outreach.system_prompt`):
```
–¢—ã ‚Äî –ú–∞–∫—Å, –æ—Å–Ω–æ–≤–∞—Ç–µ–ª—å –±–æ—Ç–∞ @Photo_2_StickerBot.
–ù–∞–ø–∏—à–∏ –∫–æ—Ä–æ—Ç–∫–æ–µ (2-3 –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è) –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –Ω–æ–≤–æ–º—É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é.
–¶–µ–ª—å ‚Äî —É–∑–Ω–∞—Ç—å –ø–æ—á–µ–º—É –æ–Ω –Ω–µ –∫—É–ø–∏–ª –∫—Ä–µ–¥–∏—Ç—ã –∏ —á—Ç–æ –º–æ–∂–Ω–æ —É–ª—É—á—à–∏—Ç—å.
–¢–æ–Ω: –¥—Ä—É–∂–µ–ª—é–±–Ω—ã–π, –Ω–µ—Ñ–æ—Ä–º–∞–ª—å–Ω—ã–π, –±–µ–∑ –¥–∞–≤–ª–µ–Ω–∏—è.
–Ø–∑—ã–∫: {lang}.
–ù–ï —É–ø–æ–º–∏–Ω–∞–π AI, –Ω–µ–π—Ä–æ—Å–µ—Ç–∏, –º–æ–¥–µ–ª–∏.
–ù–ï –ø—Ä–µ–¥–ª–∞–≥–∞–π —Å–∫–∏–¥–∫–∏.
–û–±—Ä–∞—â–∞–π—Å—è –ø–æ –∏–º–µ–Ω–∏ –µ—Å–ª–∏ –µ—Å—Ç—å.
```

**–ú–æ–¥–µ–ª—å**: `gpt-4o-mini` (–±—ã—Å—Ç—Ä–æ, –¥—ë—à–µ–≤–æ).

**–†–µ–∑—É–ª—å—Ç–∞—Ç**: —Ç–µ–∫—Å—Ç —Å–æ–æ–±—â–µ–Ω–∏—è —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –≤ –ë–î.

### 2. –•—Ä–∞–Ω–µ–Ω–∏–µ outreach –≤ –ë–î

**–ù–æ–≤–∞—è —Ç–∞–±–ª–∏—Ü–∞ `user_outreach`**:

```sql
CREATE TABLE IF NOT EXISTS user_outreach (
  id uuid PRIMARY KEY DEFAULT gen_random_uuid(),
  user_id uuid NOT NULL REFERENCES users(id),
  telegram_id bigint NOT NULL,
  message_text text NOT NULL,
  status text NOT NULL DEFAULT 'draft',  -- draft / sent / replied / expired
  reply_text text,
  replied_at timestamptz,
  sent_at timestamptz,
  alert_message_id bigint,               -- ID —Å–æ–æ–±—â–µ–Ω–∏—è –≤ –∞–ª–µ—Ä—Ç-–∫–∞–Ω–∞–ª–µ (–¥–ª—è editMessage)
  env text DEFAULT 'prod',
  created_at timestamptz DEFAULT now()
);

CREATE INDEX idx_outreach_user ON user_outreach(user_id);
CREATE INDEX idx_outreach_status ON user_outreach(status) WHERE status = 'draft';
```

### 3. –ê–ª–µ—Ä—Ç –Ω–æ–≤–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è —Å –ø—Ä–µ–≤—å—é —Å–æ–æ–±—â–µ–Ω–∏—è

**–§–∞–π–ª**: `src/index.ts` ‚Äî –±–ª–æ–∫ `sendNotification` –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –Ω–æ–≤–æ–≥–æ —é–∑–µ—Ä–∞

–§–æ—Ä–º–∞—Ç –∞–ª–µ—Ä—Ç–∞:
```
üÜï –ù–æ–≤—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å

üë§ @username (123456789)
üåê –Ø–∑—ã–∫: ru
üì¢ –ò—Å—Ç–æ—á–Ω–∏–∫: yandex/cpc

‚úâÔ∏è Outreach:
"–ü—Ä–∏–≤–µ—Ç, –ê–Ω–∞—Ä! –ó–∞–º–µ—Ç–∏–ª —á—Ç–æ —Ç—ã –ø–æ–ø—Ä–æ–±–æ–≤–∞–ª –±–æ—Ç–∞ ‚Äî
–∫–∞–∫ —Ç–µ–±–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç? –ß—Ç–æ –±—ã —Ç—ã —Ö–æ—Ç–µ–ª —É–ª—É—á—à–∏—Ç—å? üôè"

[üî• -10%] [üî• -15%] [üî• -25%]
[‚úâÔ∏è –û—Ç–ø—Ä–∞–≤–∏—Ç—å] [üîÑ –ó–∞–Ω–æ–≤–æ]
```

–ö–Ω–æ–ø–∫–∏:
- `admin_discount:TG_ID:10/15/25` ‚Äî —Å–∫–∏–¥–∫–∏ (—É–∂–µ –µ—Å—Ç—å)
- `admin_send_outreach:OUTREACH_ID` ‚Äî –æ—Ç–ø—Ä–∞–≤–∏—Ç—å —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
- `admin_regen_outreach:OUTREACH_ID` ‚Äî –ø–µ—Ä–µ–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ

### 4. –û–±—Ä–∞–±–æ—Ç—á–∏–∫ `admin_send_outreach`

**–§–∞–π–ª**: `src/index.ts` ‚Äî –Ω–æ–≤—ã–π callback handler

–õ–æ–≥–∏–∫–∞:
1. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ –∫–ª–∏–∫–Ω—É–≤—à–∏–π ‚Äî admin
2. –ó–∞–≥—Ä—É–∑–∏—Ç—å outreach –∏–∑ –ë–î –ø–æ ID, –ø—Ä–æ–≤–µ—Ä–∏—Ç—å `status = 'draft'`
3. –û—Ç–ø—Ä–∞–≤–∏—Ç—å `message_text` –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é —á–µ—Ä–µ–∑ Telegram API
4. –î–æ–±–∞–≤–∏—Ç—å inline-–∫–Ω–æ–ø–∫—É "üí¨ –û—Ç–≤–µ—Ç–∏—Ç—å" ‚Üí `https://t.me/{SUPPORT_BOT_USERNAME}?start=outreach_{OUTREACH_ID}`
5. –û–±–Ω–æ–≤–∏—Ç—å outreach: `status = 'sent'`, `sent_at = now()`
6. –û–±–Ω–æ–≤–∏—Ç—å –∞–ª–µ—Ä—Ç ‚Üí `‚úÖ –û—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ @username`
7. –ü—Ä–∏ –æ—à–∏–±–∫–µ ‚Üí `‚ùå –ë–æ—Ç –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω @username`

### 5. –û–±—Ä–∞–±–æ—Ç—á–∏–∫ `admin_regen_outreach`

**–§–∞–π–ª**: `src/index.ts` ‚Äî –Ω–æ–≤—ã–π callback handler

–õ–æ–≥–∏–∫–∞:
1. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å admin
2. –í—ã–∑–≤–∞—Ç—å AI –∑–∞–Ω–æ–≤–æ —Å —Ç–µ–º–∏ –∂–µ –¥–∞–Ω–Ω—ã–º–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
3. –û–±–Ω–æ–≤–∏—Ç—å `message_text` –≤ –ë–î
4. –û–±–Ω–æ–≤–∏—Ç—å —Ç–µ–∫—Å—Ç –∞–ª–µ—Ä—Ç–∞ —Å –Ω–æ–≤—ã–º –ø—Ä–µ–≤—å—é
5. –ö–Ω–æ–ø–∫–∏ –æ—Å—Ç–∞—é—Ç—Å—è –ø—Ä–µ–∂–Ω–∏–º–∏

### 6. Deeplink –≤ support –±–æ—Ç–µ

**–§–∞–π–ª**: `src/support-bot.ts` ‚Äî –æ–±—Ä–∞–±–æ—Ç–∫–∞ payload `outreach_`

–í `bot.start`:
```
if (payload?.startsWith("outreach_")) {
  const outreachId = payload.replace("outreach_", "");
  pendingOutreach.set(ctx.from.id, outreachId);
  // "–°–ø–∞—Å–∏–±–æ —á—Ç–æ –æ—Ç–≤–µ—Ç–∏–ª–∏! –ù–∞–ø–∏—à–∏—Ç–µ ‚Äî –º—ã –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –ø—Ä–æ—á–∏—Ç–∞–µ–º üôè"
}
```

–í `bot.on("text")`:
```
if (pendingOutreach.has(telegramId)) {
  const outreachId = pendingOutreach.get(telegramId);
  // UPDATE user_outreach SET reply_text = ..., status = 'replied', replied_at = now()
  // –û—Ç–ø—Ä–∞–≤–∏—Ç—å –≤ ALERT_CHANNEL_ID: "üí¨ –û—Ç–≤–µ—Ç –æ—Ç @username: ..."
  // "–°–ø–∞—Å–∏–±–æ –∑–∞ –æ—Ç–≤–µ—Ç! üôè"
}
```

### 7. –ü–µ—Ä–µ—Å—ã–ª–∫–∞ –æ—Ç–≤–µ—Ç–∞ –≤ –∞–ª–µ—Ä—Ç-–∫–∞–Ω–∞–ª

–û—Ç–≤–µ—Ç –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è –≤ `ALERT_CHANNEL_ID` (—á–µ—Ä–µ–∑ –æ—Å–Ω–æ–≤–Ω–æ–π –±–æ—Ç, —Ç.–∫. –æ–Ω —É–∂–µ –≤ –∫–∞–Ω–∞–ª–µ).
Support –±–æ—Ç –≤—ã–∑—ã–≤–∞–µ—Ç HTTP API —Å `config.telegramBotToken`.

–§–æ—Ä–º–∞—Ç:
```
üí¨ –û—Ç–≤–µ—Ç –Ω–∞ outreach

üë§ @username (123456789)
üì® –ë—ã–ª–æ: "–ü—Ä–∏–≤–µ—Ç, –ê–Ω–∞—Ä! –ó–∞–º–µ—Ç–∏–ª —á—Ç–æ..."
üí¨ –û—Ç–≤–µ—Ç: "–ú–Ω–µ –ø–æ–∫–∞–∑–∞–ª–æ—Å—å –¥–æ—Ä–æ–≥–æ –∑–∞ —Å—Ç–∏–∫–µ—Ä—ã"
```

### 8. –¢–µ–∫—Å—Ç—ã –≤ –ë–î

**SQL –º–∏–≥—Ä–∞—Ü–∏—è**:
```sql
INSERT INTO bot_texts_new (lang, key, text) VALUES
  ('ru', 'outreach.system_prompt',
   '–¢—ã ‚Äî –ú–∞–∫—Å, –æ—Å–Ω–æ–≤–∞—Ç–µ–ª—å –±–æ—Ç–∞ @Photo_2_StickerBot –∫–æ—Ç–æ—Ä—ã–π –¥–µ–ª–∞–µ—Ç —Å—Ç–∏–∫–µ—Ä—ã –∏–∑ —Ñ–æ—Ç–æ. –ù–∞–ø–∏—à–∏ –∫–æ—Ä–æ—Ç–∫–æ–µ (2-3 –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è) –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –Ω–æ–≤–æ–º—É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é. –¶–µ–ª—å ‚Äî —É–∑–Ω–∞—Ç—å –ø–æ—á–µ–º—É –æ–Ω –Ω–µ –∫—É–ø–∏–ª –∫—Ä–µ–¥–∏—Ç—ã –∏ —á—Ç–æ –º–æ–∂–Ω–æ —É–ª—É—á—à–∏—Ç—å. –¢–æ–Ω: –¥—Ä—É–∂–µ–ª—é–±–Ω—ã–π, –Ω–µ—Ñ–æ—Ä–º–∞–ª—å–Ω—ã–π, –±–µ–∑ –¥–∞–≤–ª–µ–Ω–∏—è. –ù–ï —É–ø–æ–º–∏–Ω–∞–π AI, –Ω–µ–π—Ä–æ—Å–µ—Ç–∏, –º–æ–¥–µ–ª–∏. –ù–ï –ø—Ä–µ–¥–ª–∞–≥–∞–π —Å–∫–∏–¥–∫–∏. –û–±—Ä–∞—â–∞–π—Å—è –ø–æ –∏–º–µ–Ω–∏ –µ—Å–ª–∏ –µ—Å—Ç—å.'),
  ('en', 'outreach.system_prompt',
   'You are Max, founder of @Photo_2_StickerBot that turns photos into stickers. Write a short (2-3 sentences) personal message to a new user. Goal: find out why they didn''t buy credits and what can be improved. Tone: friendly, informal, no pressure. Do NOT mention AI, neural networks, models. Do NOT offer discounts. Use their name if available.'),
  ('ru', 'outreach.reply_prompt',
   '–°–ø–∞—Å–∏–±–æ —á—Ç–æ –æ—Ç–≤–µ—Ç–∏–ª–∏! –ù–∞–ø–∏—à–∏—Ç–µ ‚Äî –º—ã –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –ø—Ä–æ—á–∏—Ç–∞–µ–º üôè'),
  ('en', 'outreach.reply_prompt',
   'Thanks for replying! Write your thoughts ‚Äî we will definitely read them üôè')
ON CONFLICT (lang, key) DO UPDATE SET text = EXCLUDED.text;
```

## –ó–∞—Ç—Ä–∞–≥–∏–≤–∞–µ–º—ã–µ —Ñ–∞–π–ª—ã

| –§–∞–π–ª | –ò–∑–º–µ–Ω–µ–Ω–∏—è |
|------|-----------|
| `src/index.ts` | AI –≥–µ–Ω–µ—Ä–∞—Ü–∏—è outreach –ø—Ä–∏ /start, –∫–Ω–æ–ø–∫–∏ –≤ –∞–ª–µ—Ä—Ç–µ, callback handlers `admin_send_outreach` –∏ `admin_regen_outreach` |
| `src/support-bot.ts` | Deeplink `outreach_ID`, —Å–±–æ—Ä –æ—Ç–≤–µ—Ç–∞, –ø–µ—Ä–µ—Å—ã–ª–∫–∞ –≤ –∞–ª–µ—Ä—Ç-–∫–∞–Ω–∞–ª, —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ –ë–î |
| SQL –º–∏–≥—Ä–∞—Ü–∏—è | –¢–∞–±–ª–∏—Ü–∞ `user_outreach`, —Ç–µ–∫—Å—Ç—ã –≤ `bot_texts_new` |

## –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏

- `gpt-4o-mini` –∏–ª–∏ `gemini-2.0-flash` –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ —Å–æ–æ–±—â–µ–Ω–∏–π
- Support –±–æ—Ç (`SUPPORT_BOT_TOKEN`, `SUPPORT_BOT_USERNAME`) ‚Äî —É–∂–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω
- `ALERT_CHANNEL_ID` ‚Äî —É–∂–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω

## –ü–æ–¥–≤–æ–¥–Ω—ã–µ –∫–∞–º–Ω–∏

1. **–ë–æ—Ç –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω** ‚Äî try/catch + "‚ùå –ë–æ—Ç –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω" –≤ –∞–ª–µ—Ä—Ç–µ
2. **AI –≥–µ–Ω–µ—Ä–∞—Ü–∏—è –ø—Ä–∏ /start –∑–∞–º–µ–¥–ª–∏—Ç —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—é** ‚Äî –¥–µ–ª–∞—Ç—å async (–Ω–µ –±–ª–æ–∫–∏—Ä—É–µ—Ç /start). –ï—Å–ª–∏ AI –Ω–µ —É—Å–ø–µ–ª ‚Äî –∫–Ω–æ–ø–∫–∞ "–ù–∞–ø–∏—Å–∞—Ç—å" –±–µ–∑ –ø—Ä–µ–≤—å—é, –≥–µ–Ω–µ—Ä–∞—Ü–∏—è –ø–æ –∫–ª–∏–∫—É
3. **–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –Ω–∞–∂–∞–ª "–û—Ç–≤–µ—Ç–∏—Ç—å"** ‚Äî –Ω–æ—Ä–º–∞–ª—å–Ω–æ, outreach –æ—Å—Ç–∞—ë—Ç—Å—è –≤ `status: sent`
4. **pendingOutreach —Ç–µ—Ä—è–µ—Ç—Å—è –ø—Ä–∏ —Ä–µ—Å—Ç–∞—Ä—Ç–µ support –±–æ—Ç–∞** ‚Äî –¥–ª—è MVP in-memory –æ–∫. –ú–æ–∂–Ω–æ –ø–æ `outreach_ID` –ø—Ä–æ–≤–µ—Ä—è—Ç—å –≤ –ë–î (`status: sent`)
5. **–ü–µ—Ä–µ–≥–µ–Ω–µ—Ä–∞—Ü–∏—è** ‚Äî –Ω–µ –º–µ–Ω—è—Ç—å ID, –ø—Ä–æ—Å—Ç–æ UPDATE `message_text`
6. **–î—É–±–ª–∏** ‚Äî –æ–¥–∏–Ω outreach –Ω–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è. –ü—Ä–∏ –ø–æ–≤—Ç–æ—Ä–Ω–æ–º /start –Ω–µ —Å–æ–∑–¥–∞–≤–∞—Ç—å –Ω–æ–≤—ã–π

## Checklist

- [ ] SQL –º–∏–≥—Ä–∞—Ü–∏—è: —Ç–∞–±–ª–∏—Ü–∞ `user_outreach`
- [ ] SQL –º–∏–≥—Ä–∞—Ü–∏—è: —Ç–µ–∫—Å—Ç—ã `outreach.system_prompt` –∏ `outreach.reply_prompt`
- [ ] AI –≥–µ–Ω–µ—Ä–∞—Ü–∏—è outreach –ø—Ä–∏ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –Ω–æ–≤–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- [ ] –ü—Ä–µ–≤—å—é outreach –≤ –∞–ª–µ—Ä—Ç–µ –Ω–æ–≤–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- [ ] Callback handler `admin_send_outreach:ID`
- [ ] Callback handler `admin_regen_outreach:ID`
- [ ] Deeplink `outreach_ID` –≤ support –±–æ—Ç–µ
- [ ] –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –æ—Ç–≤–µ—Ç–∞ –≤ `user_outreach`
- [ ] –ü–µ—Ä–µ—Å—ã–ª–∫–∞ –æ—Ç–≤–µ—Ç–∞ –≤ –∞–ª–µ—Ä—Ç-–∫–∞–Ω–∞–ª
- [ ] –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–∫–∏ "–±–æ—Ç –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω"
- [ ] –¢–µ—Å—Ç –Ω–∞ test-–æ–∫—Ä—É–∂–µ–Ω–∏–∏
