# Sticker Trim & Resize — Требования

## Проблема

После удаления фона (Pixian) стикер содержит много прозрачности вокруг объекта. При ресайзе до 512x512 объект остаётся мелким и не занимает всю площадь стикера.

---

## Текущее поведение

```typescript
const stickerBuffer = await sharp(noBgBuffer)
  .resize(512, 512, { fit: "fill" })
  .webp()
  .toBuffer();
```

**Результат:** Стикер 512x512, но объект занимает ~30-50% площади.

---

## Новое поведение

```typescript
const stickerBuffer = await sharp(noBgBuffer)
  .trim()  // Обрезает прозрачные края
  .resize(512, 512, { 
    fit: "contain",  // Вписывает с сохранением пропорций
    background: { r: 0, g: 0, b: 0, alpha: 0 }  // Прозрачный фон
  })
  .webp()
  .toBuffer();
```

**Результат:** Объект максимально заполняет 512x512, сохраняя пропорции.

---

## Логика

1. `trim()` — удаляет прозрачные пиксели по краям изображения
2. `resize(512, 512, { fit: "contain" })` — вписывает объект в квадрат 512x512:
   - Если объект шире — масштабируется по ширине
   - Если объект выше — масштабируется по высоте
   - Пропорции сохраняются
3. `background: { r: 0, g: 0, b: 0, alpha: 0 }` — заполняет оставшееся пространство прозрачностью

---

## Место изменения

**Файл:** `src/worker.ts`

**Строки:** ~134-138

---

## Чеклист

- [ ] Заменить `resize(512, 512, { fit: "fill" })` на `trim()` + `resize(512, 512, { fit: "contain", background: transparent })`
- [ ] Протестировать с разными фото
- [ ] Убедиться, что стикер корректно отправляется в Telegram
