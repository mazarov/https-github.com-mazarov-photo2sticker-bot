# Credit Packs v2 ‚Äî –ù–æ–≤–∞—è –ª–∏–Ω–µ–π–∫–∞ –ø–∞–∫–µ—Ç–æ–≤

## –¶–µ–ª—å

–ü–µ—Ä–µ—Ä–∞–±–æ—Ç–∞—Ç—å —Ç–∞—Ä–∏—Ñ–Ω—É—é —Å–µ—Ç–∫—É –ø–æ–¥ —Ä–µ–∞–ª—å–Ω—É—é —ç–∫–æ–Ω–æ–º–∏–∫—É –ø–∞–∫–æ–≤ —Å—Ç–∏–∫–µ—Ä–æ–≤.
–î–æ–±–∞–≤–∏—Ç—å –≤—ã–≥–æ–¥–Ω—ã–π trial-–ø–∞–∫–µ—Ç –¥–ª—è –ø–µ—Ä–≤–æ–π –ø–æ–∫—É–ø–∫–∏ —Å –±–æ–Ω—É—Å–Ω—ã–º–∏ –∫—Ä–µ–¥–∏—Ç–∞–º–∏.

---

## –ë–∞–∑–æ–≤—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã

| –ü–∞—Ä–∞–º–µ—Ç—Ä | –ó–Ω–∞—á–µ–Ω–∏–µ |
|---|---|
| 100 Telegram Stars | $1.30 |
| 1 Star | $0.013 ‚âà 1.04 ‚ÇΩ |
| –ö—É—Ä—Å ‚ÇΩ/$ | 80 ‚ÇΩ –∑–∞ $1 |
| 1 –ø–∞–∫ —Å—Ç–∏–∫–µ—Ä–æ–≤ | 10 –∫—Ä–µ–¥–∏—Ç–æ–≤ |
| –°–µ–±–µ—Å—Ç–æ–∏–º–æ—Å—Ç—å 1 –ø–∞–∫–∞ | 15 ‚ÇΩ |
| –°–µ–±–µ—Å—Ç–æ–∏–º–æ—Å—Ç—å 1 –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ | ~1.5 ‚ÇΩ (15‚ÇΩ / 10 –∫—Ä–µ–¥–∏—Ç–æ–≤) |

---

## –£—Ç–≤–µ—Ä–∂–¥—ë–Ω–Ω–∞—è –ª–∏–Ω–µ–π–∫–∞

### Trial-–ø–∞–∫–µ—Ç (—Ç–æ–ª—å–∫–æ –ø–µ—Ä–≤–∞—è –ø–æ–∫—É–ø–∫–∞)

| –ü–∞–∫–µ—Ç | –û–ø–ª–∞—Ç–∞ –∫—Ä–µ–¥–∏—Ç–æ–≤ | –ë–æ–Ω—É—Å | –ò—Ç–æ–≥–æ –∫—Ä–µ–¥–∏—Ç–æ–≤ | Stars | ‚ÇΩ | Stars/–≥–µ–Ω | –ú–∞—Ä–∂–∞ % | –£—Å–ª–æ–≤–∏–µ |
|---|---|---|---|---|---|---|---|---|
| üéÅ –ü–æ–ø—Ä–æ–±—É–π | 5 | +5 free | **10** | 49‚≠ê | ~51‚ÇΩ | 4.9 | 247% | `trialOnly` ‚Äî —Å–∫—Ä—ã–≤–∞–µ—Ç—Å—è –ø–æ—Å–ª–µ 1–π –ø–æ–∫—É–ø–∫–∏ |

### –û—Å–Ω–æ–≤–Ω—ã–µ –ø–∞–∫–µ—Ç—ã (–≤—Å–µ–≥–¥–∞ –≤–∏–¥–∏–º—ã–µ)

| –ü–∞–∫–µ—Ç | –ö—Ä–µ–¥–∏—Ç—ã | –ü–∞–∫–æ–≤ | Stars | ‚ÇΩ | Stars/–≥–µ–Ω | –ú–∞—Ä–∂–∞ % |
|---|---|---|---|---|---|---|
| ‚≠ê –°—Ç–∞—Ä—Ç | 10 | 1 | 75‚≠ê | ~78‚ÇΩ | 7.5 | 420% |
| üíé –ü–æ–ø | 30 | 3 | 175‚≠ê | ~182‚ÇΩ | 5.8 | 304% |
| üëë –ü—Ä–æ | 100 | 10 | 500‚≠ê | ~520‚ÇΩ | 5.0 | 247% |
| üöÄ –ú–∞–∫—Å | 250 | 25 | 1125‚≠ê | ~1170‚ÇΩ | 4.5 | 212% |

### –°–ª—É–∂–µ–±–Ω—ã–π –ø–∞–∫–µ—Ç

| –ü–∞–∫–µ—Ç | –ö—Ä–µ–¥–∏—Ç—ã | Stars | –£—Å–ª–æ–≤–∏–µ |
|---|---|---|---|
| üîß –¢–µ—Å—Ç | 1 | 1‚≠ê | `adminOnly` |

---

## –°–∫–∏–¥–æ—á–Ω—ã–µ –ø–∞–∫–µ—Ç—ã (hidden)

–î–ª—è –ø—Ä–æ–º–æ, abandoned cart, admin-–¥–∏—Å–∫–æ–Ω—Ç–æ–≤. –ù–µ –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç—Å—è –≤ UI, –≤—ã–∑—ã–≤–∞—é—Ç—Å—è —á–µ—Ä–µ–∑ –ø—Ä—è–º–æ–π callback.

–°–∫–∏–¥–∫–∏: **-10%**, **-15%**, **-25%** –æ—Ç Stars-—Ü–µ–Ω—ã –∫–∞–∂–¥–æ–≥–æ –æ—Å–Ω–æ–≤–Ω–æ–≥–æ –ø–∞–∫–µ—Ç–∞.

### Stars-—Ü–µ–Ω—ã —Å–æ —Å–∫–∏–¥–∫–∞–º–∏

| –°–∫–∏–¥–∫–∞ | –ü–æ–ø—Ä–æ–±—É–π | –°—Ç–∞—Ä—Ç | –ü–æ–ø | –ü—Ä–æ | –ú–∞–∫—Å |
|---|---|---|---|---|---|
| –ë–∞–∑–æ–≤–∞—è | 49‚≠ê | 75‚≠ê | 175‚≠ê | 500‚≠ê | 1125‚≠ê |
| -10% | 44‚≠ê | 68‚≠ê | 158‚≠ê | 450‚≠ê | 1013‚≠ê |
| -15% | 42‚≠ê | 64‚≠ê | 149‚≠ê | 425‚≠ê | 956‚≠ê |
| -25% | 37‚≠ê | 56‚≠ê | 131‚≠ê | 375‚≠ê | 844‚≠ê |

### –†—É–±–ª—ë–≤—ã–µ —Ü–µ–Ω—ã —Å–æ —Å–∫–∏–¥–∫–∞–º–∏ (~Stars √ó 1.04)

| –°–∫–∏–¥–∫–∞ | –ü–æ–ø—Ä–æ–±—É–π | –°—Ç–∞—Ä—Ç | –ü–æ–ø | –ü—Ä–æ | –ú–∞–∫—Å |
|---|---|---|---|---|---|
| –ë–∞–∑–æ–≤–∞—è | 51‚ÇΩ | 78‚ÇΩ | 182‚ÇΩ | 520‚ÇΩ | 1170‚ÇΩ |
| -10% | 46‚ÇΩ | 71‚ÇΩ | 164‚ÇΩ | 468‚ÇΩ | 1054‚ÇΩ |
| -15% | 44‚ÇΩ | 67‚ÇΩ | 155‚ÇΩ | 442‚ÇΩ | 994‚ÇΩ |
| -25% | 38‚ÇΩ | 58‚ÇΩ | 136‚ÇΩ | 390‚ÇΩ | 878‚ÇΩ |

### –†–µ–∞–ª–∏–∑–∞—Ü–∏—è —Å–∫–∏–¥–æ—á–Ω—ã—Ö –ø–∞–∫–µ—Ç–æ–≤

–ö–∞–∂–¥—ã–π —Å–∫–∏–¥–æ—á–Ω—ã–π –ø–∞–∫–µ—Ç ‚Äî –æ—Ç–¥–µ–ª—å–Ω–∞—è –∑–∞–ø–∏—Å—å –≤ `CREDIT_PACKS` —Å:
- `hidden: true` ‚Äî –Ω–µ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è –≤ `sendBuyCreditsMenu`
- –¢–µ –∂–µ `credits` –∏ `bonus_credits` —á—Ç–æ —É –±–∞–∑–æ–≤–æ–≥–æ –ø–∞–∫–µ—Ç–∞
- –ü–µ—Ä–µ—Å—á–∏—Ç–∞–Ω–Ω—ã–µ `price` (Stars) –∏ `price_rub`
- Label —Å —Å—É—Ñ—Ñ–∏–∫—Å–æ–º —Å–∫–∏–¥–∫–∏: `"‚≠ê –°—Ç–∞—Ä—Ç -10%"`

### –ì–¥–µ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è —Å–∫–∏–¥–æ—á–Ω—ã–µ –ø–∞–∫–µ—Ç—ã (3 —Ç–æ—á–∫–∏ –≤ –∫–æ–¥–µ)

#### 1. Admin alert channel ‚Äî –∫–Ω–æ–ø–∫–∏ `admin_discount:TID:10/15/25`

–ü—Ä–∏ paywall, —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –∏ outreach –≤ alert-–∫–∞–Ω–∞–ª –æ—Ç–ø—Ä–∞–≤–ª—è—é—Ç—Å—è –∫–Ω–æ–ø–∫–∏:
```
üî• -10%  üî• -15%  üî• -25%
```
Callback: `admin_discount:{telegramId}:{percent}`

**–ß—Ç–æ –º–µ–Ω—è—Ç—å**: –Ω–∏—á–µ–≥–æ ‚Äî –∫–Ω–æ–ø–∫–∏ –≥–µ–Ω–µ—Ä–∏—Ä—É—é—Ç—Å—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏, callback —Ñ–æ—Ä–º–∞—Ç –Ω–µ –º–µ–Ω—è–µ—Ç—Å—è.

#### 2. `admin_discount` callback handler

–§–∏–ª—å—Ç—Ä—É–µ—Ç `CREDIT_PACKS` –ø–æ —Å—É—Ñ—Ñ–∏–∫—Å—É:
```typescript
const discountSuffix = `-${discountPercent}%`;
const discountPacks = CREDIT_PACKS.filter(
  (p: any) => p.hidden && p.label_en.endsWith(discountSuffix)
);
```
–û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é –∏–Ω–ª–∞–π–Ω-–∫–Ω–æ–ø–∫–∏ —Å–æ —Å–∫–∏–¥–æ—á–Ω—ã–º–∏ –ø–∞–∫–µ—Ç–∞–º–∏.

**–ß—Ç–æ –º–µ–Ω—è—Ç—å**: –Ω–∏—á–µ–≥–æ –≤ –ª–æ–≥–∏–∫–µ ‚Äî —Ñ–æ—Ä–º–∞—Ç label —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è (`"‚≠ê Start -10%"`). –ù–æ–≤—ã–µ –ø–∞–∫–µ—Ç—ã –ø–æ–¥—Ö–≤–∞—Ç—è—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–æ—Å–ª–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è `CREDIT_PACKS`.

–í–∞–∂–Ω–æ: —Å–∫–∏–¥–æ—á–Ω—ã–π Trial (`üéÅ Try -10%`) —Ç–æ–∂–µ –¥–æ–ª–∂–µ–Ω –Ω–∞—á–∏—Å–ª—è—Ç—å `bonus_credits`, –ø–æ—ç—Ç–æ–º—É `bonus_credits` –Ω–∞—Å–ª–µ–¥—É–µ—Ç—Å—è –æ—Ç –±–∞–∑–æ–≤–æ–≥–æ –ø–∞–∫–µ—Ç–∞.

#### 3. Abandoned cart ‚Äî `DISCOUNT_MAP`

–¢–µ–∫—É—â–∏–π —Ö–∞—Ä–¥–∫–æ–¥:
```typescript
const DISCOUNT_MAP: Record<number, number> = {
  150: 135, // –õ–∞–π—Ç: 150 -> 135
  300: 270, // –ë—Ä–æ: 300 -> 270
};
```

**–ß—Ç–æ –º–µ–Ω—è—Ç—å**: –∑–∞–º–µ–Ω–∏—Ç—å –Ω–∞ –Ω–æ–≤—ã–µ —Ü–µ–Ω—ã:
```typescript
const DISCOUNT_MAP: Record<number, number> = {
  49: 44,    // –ü–æ–ø—Ä–æ–±—É–π: 49 -> 44 (-10%)
  75: 68,    // –°—Ç–∞—Ä—Ç: 75 -> 68 (-10%)
  175: 158,  // –ü–æ–ø: 175 -> 158 (-10%)
  500: 450,  // –ü—Ä–æ: 500 -> 450 (-10%)
  1125: 1013, // –ú–∞–∫—Å: 1125 -> 1013 (-10%)
};
```

–¢–∞–∫–∂–µ –æ–±–Ω–æ–≤–∏—Ç—å —Ç–µ–∫—Å—Ç abandoned cart —Å–æ–æ–±—â–µ–Ω–∏—è ‚Äî —Å–µ–π—á–∞—Å –∏—Å–ø–æ–ª—å–∑—É–µ—Ç `tx.amount` (–∫—Ä–µ–¥–∏—Ç—ã) –∏ `tx.price` (Stars). –î–ª—è Trial-–ø–∞–∫–µ—Ç–∞ —Ç–µ–∫—Å—Ç –¥–æ–ª–∂–µ–Ω –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å **–∏—Ç–æ–≥–æ –∫—Ä–µ–¥–∏—Ç–æ–≤** (—Å –±–æ–Ω—É—Å–æ–º), –∞ –Ω–µ –æ–ø–ª–∞—á–µ–Ω–Ω—ã—Ö.

---

## –õ–æ–≥–∏–∫–∞ bonus_credits

Trial-–ø–∞–∫–µ—Ç `üéÅ –ü–æ–ø—Ä–æ–±—É–π` –Ω–∞—á–∏—Å–ª—è–µ—Ç `credits = 5` (–æ–ø–ª–∞—á–µ–Ω–Ω—ã—Ö) + `bonus_credits = 5` (–±–µ—Å–ø–ª–∞—Ç–Ω—ã—Ö).

### –†–µ–∞–ª–∏–∑–∞—Ü–∏—è

1. –ü–æ–ª–µ `bonus_credits` –≤ `CREDIT_PACKS` (default: 0).
2. –í `successful_payment`: –Ω–∞—á–∏—Å–ª—è—Ç—å `pack.credits + (pack.bonus_credits || 0)`.
3. –í UI: –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å –∏—Ç–æ–≥–æ–≤–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ: `"10 —Å—Ç–∏–∫–µ—Ä–æ–≤ ‚Äî 49‚≠ê"`.
4. Trial-–ø–∞–∫–µ—Ç —Å–∫—Ä—ã–≤–∞–µ—Ç—Å—è –ø–æ—Å–ª–µ `has_purchased = true`.

---

## –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –≤ UI

–§–æ—Ä–º–∞—Ç –∫–Ω–æ–ø–∫–∏:
```
{label}: {totalCredits} —Å—Ç–∏–∫–µ—Ä–æ–≤ ‚Äî {price}‚≠ê (~{price_rub}‚ÇΩ)
```

–ü—Ä–∏–º–µ—Ä—ã:
```
üéÅ –ü–æ–ø—Ä–æ–±—É–π: 10 —Å—Ç–∏–∫–µ—Ä–æ–≤ ‚Äî 49‚≠ê (~51‚ÇΩ)
‚≠ê –°—Ç–∞—Ä—Ç: 10 —Å—Ç–∏–∫–µ—Ä–æ–≤ ‚Äî 75‚≠ê (~78‚ÇΩ)
üíé –ü–æ–ø: 30 —Å—Ç–∏–∫–µ—Ä–æ–≤ ‚Äî 175‚≠ê (~182‚ÇΩ)
üëë –ü—Ä–æ: 100 —Å—Ç–∏–∫–µ—Ä–æ–≤ ‚Äî 500‚≠ê (~520‚ÇΩ)
üöÄ –ú–∞–∫—Å: 250 —Å—Ç–∏–∫–µ—Ä–æ–≤ ‚Äî 1125‚≠ê (~1170‚ÇΩ)
```

---

## –ß—Ç–æ –º–µ–Ω—è–µ—Ç—Å—è –≤ –∫–æ–¥–µ

### `src/index.ts`

1. **`CREDIT_PACKS`** ‚Äî –ø–æ–ª–Ω–∞—è –∑–∞–º–µ–Ω–∞ –º–∞—Å—Å–∏–≤–∞ –Ω–∞ –Ω–æ–≤—É—é –ª–∏–Ω–µ–π–∫—É (5 –æ—Å–Ω–æ–≤–Ω—ã—Ö + 1 admin).
2. **–°–∫–∏–¥–æ—á–Ω—ã–µ –ø–∞–∫–µ—Ç—ã (hidden)** ‚Äî –ø–µ—Ä–µ—Å—á–∏—Ç–∞—Ç—å –≤—Å–µ hidden-–ø–∞–∫–µ—Ç—ã (-10%, -15%, -25%) –ø–æ–¥ –Ω–æ–≤—ã–µ –±–∞–∑–æ–≤—ã–µ —Ü–µ–Ω—ã. –ö–∞–∂–¥—ã–π –æ—Å–Ω–æ–≤–Ω–æ–π –ø–∞–∫–µ—Ç (–≤–∫–ª—é—á–∞—è Trial) –ø–æ–ª—É—á–∞–µ—Ç 3 —Å–∫–∏–¥–æ—á–Ω—ã—Ö –≤–∞—Ä–∏–∞–Ω—Ç–∞ = 15 hidden-–∑–∞–ø–∏—Å–µ–π.
3. **`bonus_credits`** ‚Äî –Ω–æ–≤–æ–µ –ø–æ–ª–µ –¥–ª—è trial-–ø–∞–∫–µ—Ç–∞. –°–∫–∏–¥–æ—á–Ω—ã–µ –≤–∞—Ä–∏–∞–Ω—Ç—ã Trial —Ç–æ–∂–µ –∏–º–µ—é—Ç `bonus_credits: 5`.
4. **`successful_payment`** ‚Äî –Ω–∞—á–∏—Å–ª—è—Ç—å `credits + (bonus_credits || 0)`.
5. **`sendBuyCreditsMenu`** ‚Äî –æ—Ç–æ–±—Ä–∞–∂–∞—Ç—å –∏—Ç–æ–≥–æ –∫—Ä–µ–¥–∏—Ç–æ–≤ (`credits + bonus_credits`) –≤ —Ç–µ–∫—Å—Ç–µ –∫–Ω–æ–ø–∫–∏.
6. **`buildBalanceInfo`** ‚Äî –æ–±–Ω–æ–≤–∏—Ç—å —Ç–µ–∫—Å—Ç –¥–ª—è AI-–∞—Å—Å–∏—Å—Ç–µ–Ω—Ç–∞ —Å –Ω–æ–≤—ã–º–∏ –ø–∞–∫–µ—Ç–∞–º–∏.

### –ë–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π

- –§–ª–æ—É –æ–ø–ª–∞—Ç—ã (pre_checkout ‚Üí successful_payment).
- Idempotency.
- Paywall –ª–æ–≥–∏–∫–∞.
- Abandoned cart.
- Trial credits (AI-–∞—Å—Å–∏—Å—Ç–µ–Ω—Ç, `grant_trial_credit`).

---

## –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–π –∞–Ω—Ç–∏–¥—É–±–ª—å –æ–ø–ª–∞—Ç—ã

–ü—Ä–æ–±–ª–µ–º–∞: –±—ã—Å—Ç—Ä—ã–π –¥–≤–æ–π–Ω–æ–π/—Ç—Ä–æ–π–Ω–æ–π –∫–ª–∏–∫ –ø–æ `pack_*` –º–æ–≥ —Å–æ–∑–¥–∞—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ `created`-—Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π –∏/–∏–ª–∏ –æ—Ç–º–µ–Ω–∏—Ç—å –Ω—É–∂–Ω—É—é –¥–æ –ø—Ä–∏—Ö–æ–¥–∞ `successful_payment`, –∏–∑-–∑–∞ —á–µ–≥–æ —Å–ø–∏—Å–∞–Ω–∏–µ –≤ Telegram –ø—Ä–æ–∏—Å—Ö–æ–¥–∏–ª–æ, –∞ –∫—Ä–µ–¥–∏—Ç—ã –Ω–µ –∑–∞—á–∏—Å–ª—è–ª–∏—Å—å.

–ï–¥–∏–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ –¥–ª—è –≤—Å–µ—Ö —Ç–∞—Ä–∏—Ñ–æ–≤ (–æ–±—ã—á–Ω—ã–µ + hidden + admin_discount + abandoned cart):

1. –í `pack_select` —Å–Ω–∞—á–∞–ª–∞ –∏—â–µ—Ç—Å—è –∞–∫—Ç–∏–≤–Ω–∞—è `created`-—Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.
2. –ï—Å–ª–∏ –∞–∫—Ç–∏–≤–Ω–∞—è —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—è —Å–≤–µ–∂–∞—è (TTL 15 –º–∏–Ω—É—Ç):
   - –¥–ª—è —Ç–æ–≥–æ –∂–µ –ø–∞–∫–µ—Ç–∞ ‚Äî —Ä–µ—é–∑ —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–π —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ –∏ payload;
   - –¥–ª—è –¥—Ä—É–≥–æ–≥–æ –ø–∞–∫–µ—Ç–∞ ‚Äî –±–ª–æ–∫ —Å —Å–æ–æ–±—â–µ–Ω–∏–µ–º "–∑–∞–≤–µ—Ä—à–∏ —Ç–µ–∫—É—â—É—é –æ–ø–ª–∞—Ç—É".
3. –ù–æ–≤–∞—è —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—è —Å–æ–∑–¥–∞—ë—Ç—Å—è —Ç–æ–ª—å–∫–æ –∫–æ–≥–¥–∞ —Å–≤–µ–∂–µ–π –∞–∫—Ç–∏–≤–Ω–æ–π –Ω–µ—Ç.
4. –í `successful_payment` –¥–æ–±–∞–≤–ª–µ–Ω recovery-path: –µ—Å–ª–∏ –æ—Å–Ω–æ–≤–Ω–æ–π update –Ω–µ –Ω–∞—à—ë–ª `created`, –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –±–µ–∑–æ–ø–∞—Å–Ω–∞—è –ø–æ–ø—ã—Ç–∫–∞ –∑–∞–≤–µ—Ä—à–∏—Ç—å —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—é –ø–æ `id`/`charge_id` (–¥–ª—è –≥–æ–Ω–æ–∫ –º–µ–∂–¥—É callback-–∞–º–∏).

–≠—Ç–æ—Ç –º–µ—Ö–∞–Ω–∏–∑–º —Ü–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω –≤ –æ—Å–Ω–æ–≤–Ω–æ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–µ `pack_(credits)_(price)`, –ø–æ—ç—Ç–æ–º—É –ø–æ–∫—Ä—ã–≤–∞–µ—Ç –≤—Å–µ –≤—Ö–æ–¥—ã –≤ –æ–ø–ª–∞—Ç—É.

---

## Checklist

- [ ] –û–±–Ω–æ–≤–∏—Ç—å `CREDIT_PACKS` –≤ `index.ts` (–æ—Å–Ω–æ–≤–Ω—ã–µ + hidden —Å–∫–∏–¥–æ—á–Ω—ã–µ)
- [ ] –î–æ–±–∞–≤–∏—Ç—å `bonus_credits` –ø–æ–ª–µ –∏ –ª–æ–≥–∏–∫—É –Ω–∞—á–∏—Å–ª–µ–Ω–∏—è –≤ `successful_payment`
- [ ] –û–±–Ω–æ–≤–∏—Ç—å `sendBuyCreditsMenu` (–ø–æ–∫–∞–∑—ã–≤–∞—Ç—å –∏—Ç–æ–≥–æ credits + bonus)
- [ ] –û–±–Ω–æ–≤–∏—Ç—å `buildBalanceInfo` (—Ç–µ–∫—Å—Ç –¥–ª—è AI-–∞—Å—Å–∏—Å—Ç–µ–Ω—Ç–∞)
- [ ] –û–±–Ω–æ–≤–∏—Ç—å `DISCOUNT_MAP` –¥–ª—è abandoned cart (–Ω–æ–≤—ã–µ —Ü–µ–Ω—ã)
- [ ] –û–±–Ω–æ–≤–∏—Ç—å —Ç–µ–∫—Å—Ç abandoned cart –¥–ª—è Trial (–ø–æ–∫–∞–∑—ã–≤–∞—Ç—å –∏—Ç–æ–≥–æ —Å –±–æ–Ω—É—Å–æ–º)
- [ ] –ü—Ä–æ–≤–µ—Ä–∏—Ç—å `admin_discount` callback (label —Ñ–æ—Ä–º–∞—Ç, bonus_credits)
- [ ] –û–±–Ω–æ–≤–∏—Ç—å `docs/architecture/05-payment.md`
- [ ] –¢–µ—Å—Ç –ø–æ–∫—É–ø–∫–∏ trial-–ø–∞–∫–µ—Ç–∞ (49‚≠ê) ‚Äî –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –Ω–∞—á–∏—Å–ª–µ–Ω–∏–µ 10 –∫—Ä–µ–¥–∏—Ç–æ–≤
- [ ] –¢–µ—Å—Ç –ø–æ–∫—É–ø–∫–∏ –æ—Å–Ω–æ–≤–Ω–æ–≥–æ –ø–∞–∫–µ—Ç–∞
- [ ] –¢–µ—Å—Ç admin_discount –∏–∑ alert-–∫–∞–Ω–∞–ª–∞
- [ ] –¢–µ—Å—Ç abandoned cart reminder —Å –Ω–æ–≤—ã–º–∏ —Ü–µ–Ω–∞–º–∏
